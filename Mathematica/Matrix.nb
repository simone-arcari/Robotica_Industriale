(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    193680,       4552]
NotebookOptionsPosition[    185782,       4432]
NotebookOutlinePosition[    186273,       4451]
CellTagsIndexPosition[    186230,       4448]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Rotation Matrix [x y z]:", "Section",
 CellChangeTimes->{{3.906018314237831*^9, 3.906018340036146*^9}, {
  3.9060184286683292`*^9, 3.906018439009295*^9}, {3.9071515631387515`*^9, 
  3.907151596438959*^9}},ExpressionUUID->"0748cad9-462a-47bd-b7c6-\
dd1609856232"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Ritornano", " ", "le", " ", "relative", " ", "matrici", " ", "di", " ", 
    "rotazione", " ", "intorno", " ", "a", " ", "x"}], ",", " ", "y", ",", 
   " ", "z"}], "*)"}]], "Input",
 CellChangeTimes->{{3.912058813120875*^9, 3.912058844933436*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"0cf7fa7a-05de-4f71-89f7-00c3dcfdc597"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Rx", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Alpha]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NumericQ", "[", "\[Theta]", "]"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "\[Theta]", "]"}], "===", "Symbol"}], ")"}], 
         " ", "||", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"StringQ", "[", 
            RowBox[{"ToString", "[", "\[Theta]", "]"}], "]"}], "&&", 
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"ToString", "[", "\[Theta]", "]"}], ",", "1"}], "]"}], 
            "===", "\"\<-\>\""}]}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
        "se", " ", "\[EGrave]", " ", "uno", " ", "scalare", " ", "o", " ", 
         "un", " ", "simbolo"}]}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "\[Theta]", "]"}], ",", " ", 
       RowBox[{
       "Print", "[", "\"\<The argument must be a scalar or symbol\>\"", " ", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]", "=", 
         RowBox[{"Rationalize", "[", "\[Theta]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}], ",", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9060154930000353`*^9, 3.906015494262191*^9}, {
   3.9060156261690445`*^9, 3.9060156490685177`*^9}, {3.906015687136239*^9, 
   3.9060157240310307`*^9}, {3.906015777892974*^9, 3.906015810022784*^9}, {
   3.9060158748613167`*^9, 3.9060160048180265`*^9}, {3.906016194814868*^9, 
   3.906016195530864*^9}, 3.906016530950591*^9, {3.9060167821979637`*^9, 
   3.906016842020614*^9}, {3.906016894445938*^9, 3.906016899504116*^9}, {
   3.9060170473771324`*^9, 3.906017052076618*^9}, {3.9060171655493517`*^9, 
   3.9060171837620926`*^9}, {3.906017262998313*^9, 3.9060172861915827`*^9}, 
   3.906017489903354*^9, {3.906017957738822*^9, 3.906017958615199*^9}, {
   3.906017994005779*^9, 3.906018094609125*^9}, {3.9060181320329733`*^9, 
   3.9060182385359216`*^9}, 3.9060182892525187`*^9, 3.9060187182443905`*^9, {
   3.9060196840845213`*^9, 3.906019685217224*^9}, 3.9060199910411787`*^9, 
   3.906132000606843*^9, {3.9061325266489086`*^9, 3.9061325271715307`*^9}, {
   3.906132742696579*^9, 3.906132750307907*^9}, {3.9061332329892926`*^9, 
   3.906133242370713*^9}, 3.906133347491825*^9, {3.906133402342929*^9, 
   3.906133407021167*^9}, {3.906133575047719*^9, 3.906133601479991*^9}, {
   3.906134708714674*^9, 3.906134817145054*^9}, {3.9061348985156918`*^9, 
   3.90613490138171*^9}, 3.9061421155965834`*^9, 3.90614253110049*^9, {
   3.9061425725631523`*^9, 3.9061425998673353`*^9}, 3.9061427609312906`*^9, {
   3.9061430384528875`*^9, 3.906143051017419*^9}, {3.906364970985403*^9, 
   3.9063649750295324`*^9}, {3.906365009327857*^9, 3.9063650659001427`*^9}, {
   3.906365192447383*^9, 3.9063652316006775`*^9}, {3.906873738358163*^9, 
   3.906873819986971*^9}, 3.913625897278201*^9, 3.9136259373270597`*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"6315e9fb-a5e0-45a2-b98d-d74e131bcbcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Ry", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "\[Alpha]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", "\[Theta]", "]"}], ",", " ", 
       RowBox[{
       "Print", "[", "\"\<The argument must be a scalar or symbol\>\"", " ", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Alpha]", "=", 
         RowBox[{"Rationalize", "[", "\[Theta]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0", ",", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ",", "0", ",", 
            RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.9060154930000353`*^9, 3.906015494262191*^9}, {
   3.9060156261690445`*^9, 3.9060156490685177`*^9}, {3.906015687136239*^9, 
   3.9060157240310307`*^9}, {3.906015777892974*^9, 3.906015810022784*^9}, {
   3.9060158748613167`*^9, 3.9060160048180265`*^9}, {3.906016194814868*^9, 
   3.906016195530864*^9}, 3.906016530950591*^9, {3.9060167821979637`*^9, 
   3.906016842020614*^9}, {3.906016894445938*^9, 3.906016899504116*^9}, {
   3.9060170473771324`*^9, 3.906017052076618*^9}, {3.9060171655493517`*^9, 
   3.9060171837620926`*^9}, {3.906017262998313*^9, 3.9060172861915827`*^9}, 
   3.906017489903354*^9, {3.906017957738822*^9, 3.906017958615199*^9}, {
   3.906017994005779*^9, 3.906018094609125*^9}, {3.9060181320329733`*^9, 
   3.9060182385359216`*^9}, 3.9060182892525187`*^9, 3.9060184908483295`*^9, 
   3.9060187207279725`*^9, {3.9060196770945215`*^9, 3.9060196782711782`*^9}, 
   3.906019996127846*^9, {3.9060217348799963`*^9, 3.9060217352886195`*^9}, {
   3.9061324532205367`*^9, 3.906132453658069*^9}, {3.906133553970028*^9, 
   3.9061335979861593`*^9}, {3.9061336330846972`*^9, 
   3.9061336373412123`*^9}, {3.9061348508068314`*^9, 
   3.9061348914316006`*^9}, {3.9061431339622836`*^9, 
   3.9061431353206034`*^9}, {3.906365290034528*^9, 3.9063653026916504`*^9}, {
   3.906873827917953*^9, 3.9068738477471495`*^9}, {3.9136259293947797`*^9, 
   3.913625939020132*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"18953c69-e734-4cae-b4f6-ab49558318cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rz", "[", "\[Theta]_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "\[Alpha]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "\[Theta]", "]"}], ",", " ", 
      RowBox[{
      "Print", "[", "\"\<The argument must be a scalar or symbol\>\"", " ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"Rationalize", "[", "\[Theta]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sin", "[", "\[Alpha]", "]"}]}], ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sin", "[", "\[Alpha]", "]"}], ",", 
           RowBox[{"Cos", "[", "\[Alpha]", "]"}], ",", "0"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9060154930000353`*^9, 3.906015494262191*^9}, {
   3.9060156261690445`*^9, 3.9060156490685177`*^9}, {3.906015687136239*^9, 
   3.9060157240310307`*^9}, {3.906015777892974*^9, 3.906015810022784*^9}, {
   3.9060158748613167`*^9, 3.9060160048180265`*^9}, {3.906016194814868*^9, 
   3.906016195530864*^9}, 3.906016530950591*^9, {3.9060167821979637`*^9, 
   3.906016842020614*^9}, {3.906016894445938*^9, 3.906016899504116*^9}, {
   3.9060170473771324`*^9, 3.906017052076618*^9}, {3.9060171655493517`*^9, 
   3.9060171837620926`*^9}, {3.906017262998313*^9, 3.9060172861915827`*^9}, 
   3.906017489903354*^9, {3.906017957738822*^9, 3.906017958615199*^9}, {
   3.906017994005779*^9, 3.906018094609125*^9}, {3.9060181320329733`*^9, 
   3.9060182385359216`*^9}, 3.9060182892525187`*^9, 3.9060184997331133`*^9, 
   3.9060187227724752`*^9, 3.9060189135758677`*^9, {3.906019672223751*^9, 
   3.9060196737563567`*^9}, {3.9060199997366877`*^9, 
   3.9060200014259844`*^9}, {3.9060217396669893`*^9, 
   3.9060217400834274`*^9}, {3.906133607913656*^9, 3.9061336433818645`*^9}, {
   3.906133777356505*^9, 3.9061337791074347`*^9}, {3.9061349068959475`*^9, 
   3.9061349216970606`*^9}, 3.9061431417864237`*^9, {3.9063653150054274`*^9, 
   3.9063653252541027`*^9}, {3.9068738524328003`*^9, 3.906873868331995*^9}, 
   3.9136259308283353`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"337d27a7-433c-4ffa-9c25-9961f48d1f32"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Selectable Rotation Matrix:", "Section",
 CellChangeTimes->{{3.906019410702746*^9, 3.906019422412384*^9}, {
  3.9060194558369284`*^9, 3.906019475303009*^9}, {3.9060211617570906`*^9, 
  3.906021163802617*^9}, {3.9060341867883973`*^9, 
  3.9060341881901674`*^9}},ExpressionUUID->"62805a66-b370-40b1-bb49-\
59f4bd182fbb"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Ritorna", " ", "una", " ", "matrice", " ", "di", " ", "rotazione", " ", 
   "tra", " ", "Rx", " ", "Ry", " ", "Rz", "\[IndentingNewLine]", "  ", 
   RowBox[{"option", " ", ":", " ", 
    RowBox[{"una", " ", "lettera", " ", 
     RowBox[{"tra", " ", "'"}], 
     RowBox[{
      RowBox[{"x", "'"}], " ", "'"}], 
     RowBox[{
      RowBox[{"y", "'"}], " ", "'"}], 
     RowBox[{"z", "'"}], " ", "per", " ", "selezionare", " ", "la", " ", 
     "relativa", " ", "matrice", " ", "di", " ", "rotazione", 
     "\[IndentingNewLine]", "theta"}], " ", ":", " ", 
    RowBox[{"angolo", " ", "di", " ", "rotazione"}]}]}], " ", "*)"}]], "Input",\

 CellChangeTimes->{{3.912058852673191*^9, 3.912059016284026*^9}, {
  3.9120590496981297`*^9, 3.91205908794711*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"2c104067-a328-446c-ab80-0f68bdb3c1c3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RR", "[", 
   RowBox[{"option_", ",", "\[Theta]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"R", ",", "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "\[Theta]", "]"}], ",", " ", 
      RowBox[{
      "Print", "[", "\"\<The argument must be a scalar or symbol\>\"", " ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", 
        RowBox[{"Rationalize", "[", "\[Theta]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{"Switch", "[", 
         RowBox[{"option", ",", "\[IndentingNewLine]", "\"\<x\>\"", ",", 
          RowBox[{"Rx", "[", "\[Alpha]", "]"}], ",", "\[IndentingNewLine]", 
          "\"\<y\>\"", ",", 
          RowBox[{"Ry", "[", "\[Alpha]", "]"}], ",", "\[IndentingNewLine]", 
          "\"\<z\>\"", ",", 
          RowBox[{"Rz", "[", "\[Alpha]", "]"}], ",", "\[IndentingNewLine]", 
          "_", ",", 
          RowBox[{
          "Print", "[", "\"\<The argument must be a char: x,y,z\>\"", " ", 
           "]"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
          "Azione", " ", "predefinita", " ", "per", " ", "opzioni", " ", 
           "non", " ", "corrispondenti"}], "*)"}], "\[IndentingNewLine]", 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.90601948569639*^9, 3.9060196054048777`*^9}, {
   3.906019637035428*^9, 3.9060196452601814`*^9}, {3.9060196977826877`*^9, 
   3.906019983592266*^9}, {3.906020102017746*^9, 3.9060201294788513`*^9}, {
   3.9060207429813585`*^9, 3.906020795545509*^9}, {3.9060208788676414`*^9, 
   3.90602115041306*^9}, {3.9060211804681683`*^9, 3.9060213138705273`*^9}, {
   3.906021499127756*^9, 3.9060215096052103`*^9}, {3.9060215723029165`*^9, 
   3.906021635332058*^9}, {3.906021688651157*^9, 3.9060216897732835`*^9}, {
   3.9060343316148367`*^9, 3.906034332933359*^9}, {3.906131973082327*^9, 
   3.906131985583949*^9}, {3.9061320735263453`*^9, 3.906132073909867*^9}, {
   3.906133977759637*^9, 3.90613402546002*^9}, {3.9061354608678074`*^9, 
   3.9061354943397264`*^9}, {3.906135525837149*^9, 3.9061355432577267`*^9}, {
   3.906135594165397*^9, 3.906135748266473*^9}, {3.906135824243308*^9, 
   3.9061358328654795`*^9}, {3.90613586301904*^9, 3.906135884582362*^9}, 
   3.9061376233295307`*^9, {3.906365348368166*^9, 3.9063653771904435`*^9}, {
   3.913626561421774*^9, 3.913626585511099*^9}, {3.9136266920907865`*^9, 
   3.9136267122064495`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"0154067a-34a9-449f-8bf2-c78121950c6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Verify Commutativity:", "Section",
 CellChangeTimes->{{3.90603433503025*^9, 3.906034409742327*^9}, {
  3.906136800411601*^9, 
  3.906136803595789*^9}},ExpressionUUID->"d287f03a-8d9d-4d47-ba9c-\
328093f2e42b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "Esempio", " ", "di", " ", "verifica", " ", "di", " ", "propriet\[AGrave]",
     " ", "matematiche", " ", "per", " ", "le", " ", "matrici", " ", "di", 
    " ", "rotazione"}], ",", " ", 
   RowBox[{"vengono", " ", "passati", " ", "due", " ", "angoli"}], ",", " ", 
   RowBox[{
   "questa", " ", "proprit\[AGrave]", " ", "deve", " ", "sempre", " ", 
    "risultare", " ", "falsa", " ", "tranne", " ", "nel", " ", "caso", " ", 
    "di", " ", "angoli", " ", "nulli"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9136269518000464`*^9, 3.9136270026493115`*^9}, {
  3.913627126935317*^9, 3.9136271384912977`*^9}, {3.9136271873227177`*^9, 
  3.913627233002801*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"48ae197c-4942-4ecf-b365-aac7f4a157b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CommutativityM", "[", 
   RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "M1", ",", " ", "M2", ",", "\[Alpha]\[Alpha]", ",", "\[Beta]\[Beta]"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ListQ", "[", "\[Alpha]", "]"}], " ", "||", " ", 
       RowBox[{"ListQ", "[", "\[Beta]", "]"}]}], ",", " ", 
      RowBox[{
      "Print", "[", "\"\<The arguments must be a scalars or symbols\>\"", " ",
        "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Alpha]\[Alpha]", "=", 
        RowBox[{"Rationalize", "[", "\[Alpha]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Beta]\[Beta]", "=", 
        RowBox[{"Rationalize", "[", "\[Beta]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"M1", "=", 
        RowBox[{
         RowBox[{"Rx", "[", "\[Alpha]\[Alpha]", "]"}], ".", 
         RowBox[{"Ry", "[", "\[Beta]\[Beta]", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"M2", "=", 
        RowBox[{
         RowBox[{"Ry", "[", "\[Beta]\[Beta]", "]"}], ".", 
         RowBox[{"Rx", "[", "\[Alpha]\[Alpha]", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Rx[\>\"", ",", "\[Alpha]\[Alpha]", ",", "\"\<]Ry[\>\"", ",", 
         "\[Beta]\[Beta]", ",", "\"\<]=\>\"", ",", 
         RowBox[{"MatrixForm", "[", "M1", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Ry[\>\"", ",", "\[Beta]\[Beta]", ",", "\"\<]Rx[\>\"", ",", 
         "\[Alpha]\[Alpha]", ",", "\"\<]=\>\"", ",", 
         RowBox[{"MatrixForm", "[", "M2", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{"M1", "-", "M2"}], "]"}], " ", "===", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.9060344195596952`*^9, 3.906034453137532*^9}, {
   3.906034528359857*^9, 3.9060345327610645`*^9}, {3.9060345789236507`*^9, 
   3.906034688635304*^9}, {3.9060347636571913`*^9, 3.906034803187609*^9}, 
   3.906035063985903*^9, {3.906035106316141*^9, 3.906035109087633*^9}, {
   3.9060351413617663`*^9, 3.906035146859593*^9}, {3.906135935478495*^9, 
   3.906135959247374*^9}, {3.9061360088546133`*^9, 3.906136048917304*^9}, {
   3.906136097308384*^9, 3.906136099067031*^9}, {3.906136534578371*^9, 
   3.906136547655365*^9}, 3.906136630667678*^9, {3.906136913826646*^9, 
   3.90613694310441*^9}, {3.9063654049909353`*^9, 3.9063655003466144`*^9}, 
   3.906365580488737*^9, {3.913627278504854*^9, 3.9136273542221556`*^9}, {
   3.913627437135583*^9, 3.913627573673314*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"a575efd0-92d3-4922-917b-65fa13dfe38c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Euler Angles:", "Section",
 CellChangeTimes->{{3.906137525550741*^9, 3.9061375501713347`*^9}, {
  3.906365481144738*^9, 3.9063654822476563`*^9}, {3.9071453428230567`*^9, 
  3.9071453434370513`*^9}, {3.907151547621996*^9, 
  3.9071515485395355`*^9}},ExpressionUUID->"b7f9abea-dd58-4b5a-9aca-\
1d3a997b4197"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Questa", " ", "procedura", " ", "calcola", " ", "la", " ", "matrice", " ",
     "di", " ", "rotazione", " ", "desiderata", " ", "in", " ", "base", " ", 
    "ai", " ", "parametri", " ", "forniti"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"option1", " ", ":", " ", 
    RowBox[{
    "deve", " ", "essere", " ", "un", " ", "carattere", " ", "tra", " ", 
     "\"\<x\>\"", " ", "\"\<y\>\"", " ", "\"\<z\>\"", " ", "serve", " ", 
     "per", " ", "dire", " ", "ad", " ", "RR", " ", "quale", " ", "matrice", 
     " ", "utilizzare", " ", "tra", " ", "Rx", " ", "Ry", " ", "Rz", " ", 
     RowBox[{"(", 
      RowBox[{"Matrice", " ", "sinistra", " ", "e", " ", "destra"}], 
      ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"option2", " ", ":", " ", 
     RowBox[{
     "deve", " ", "essere", " ", "un", " ", "carattere", " ", "tra", " ", 
      "\"\<x\>\"", " ", "\"\<y\>\"", " ", "\"\<z\>\""}]}], ",", " ", 
    RowBox[{
    "serve", " ", "per", " ", "dire", " ", "ad", " ", "RR", " ", "quale", " ",
      "matrice", " ", "utilizzare", " ", "tra", " ", "Rx", " ", "Ry", " ", 
     "Rz", " ", 
     RowBox[{"(", 
      RowBox[{"Matrice", " ", "centrale"}], ")"}]}]}], " ", "*)"}], 
  RowBox[{"(*", " ", 
   RowBox[{"option3", " ", ":", " ", 
    RowBox[{
    "deve", " ", "essere", " ", "un", " ", "carattere", " ", "tra", " ", 
     "\"\<1\>\"", " ", "\"\<2\>\"", " ", "per", " ", "dire", " ", "quale", 
     " ", "dei", " ", "due", " ", "casi", " ", "si", " ", "desidera", " ", 
     "calcolare"}]}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"sign", " ", ":", " ", 
    RowBox[{
    "deve", " ", "essere", " ", "un", " ", "carattere", " ", "tra", " ", 
     "\"\<-\>\"", " ", "\"\<+\>\"", " ", "per", " ", "selezione", " ", "la", 
     " ", "configurazione", " ", "dei", " ", "segni", " ", "una", " ", 
     "volta", " ", "scelto", " ", "il", " ", "caso", " ", "con", " ", "il", 
     " ", "parametro", " ", "option3"}]}], " ", "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTA", " ", ":", " ", 
    RowBox[{
    "la", " ", "procedura", " ", "RR", " ", "ritorna", " ", "la", " ", 
     "matrice", " ", "Rx", " ", "Ry", " ", "Rz", " ", "selezionata"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"NOTA", " ", ":", " ", 
    RowBox[{
    "i", " ", "parametri", " ", "option3", " ", "e", " ", "sign", " ", 
     "servono", " ", "per", " ", "selezionare", " ", "1", " ", "di", " ", "4",
      " ", "possibili", " ", "configurazioni", " ", "totali"}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.912058754691975*^9, 3.912058757103096*^9}, {
  3.9136277075824356`*^9, 3.913627876731308*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"e7f15050-78af-4652-8d14-ded069b66ef2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EulerAngle", "[", 
   RowBox[{
   "option1_", ",", "option2_", ",", "option3_", ",", "sign_", ",", 
    "\[Theta]_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "\[Theta]", "]"}], ",", " ", 
      RowBox[{
      "Print", "[", "\"\<The argument 5 must be a scalar or symbol\>\"", " ", 
       "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "option3", ",", "\[IndentingNewLine]", "\"\<1\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Switch", "[", 
         RowBox[{"sign", ",", "\[IndentingNewLine]", "\t", "\"\<+\>\"", ",", 
          RowBox[{
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option2", ",", "\[Theta]"}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{
              RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", "\"\<-\>\"", ",", 
          RowBox[{
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{
              RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option2", ",", 
             RowBox[{"-", "\[Theta]"}]}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t", "_", ",", 
          RowBox[{
          "Print", "[", "\"\<The argument 4 must be a char: +,-\>\"", " ", 
           "]"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
          "Azione", " ", "predefinita", " ", "per", " ", "opzioni", " ", 
           "non", " ", "corrispondenti"}], "*)"}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "\"\<2\>\"", ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Switch", "[", 
         RowBox[{"sign", ",", "\[IndentingNewLine]", "\t", "\"\<+\>\"", ",", 
          RowBox[{
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{
              RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option2", ",", "\[Theta]"}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          "\t", "\"\<-\>\"", ",", 
          RowBox[{
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{"Pi", "/", "2"}]}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option2", ",", 
             RowBox[{"-", "\[Theta]"}]}], "]"}], ".", 
           RowBox[{"RR", "[", 
            RowBox[{"option1", ",", 
             RowBox[{
              RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", "_", ",", 
          RowBox[{
          "Print", "[", "\"\<The argument 4 must be a char: +,-\>\"", " ", 
           "]"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
          "Azione", " ", "predefinita", " ", "per", " ", "opzioni", " ", 
           "non", " ", "corrispondenti"}], "*)"}], "\[IndentingNewLine]", 
         "\t", "]"}], ",", "\[IndentingNewLine]", "_", ",", 
        RowBox[{
        "Print", "[", "\"\<The argument 3 must be a char: 1,2\>\"", " ", 
         "]"}]}], " ", "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9061375612963*^9, 3.9061376339836636`*^9}, {
  3.906137667614153*^9, 3.906137721620092*^9}, {3.9061377903338227`*^9, 
  3.9061378527709055`*^9}, {3.9061378865027285`*^9, 3.9061380330072403`*^9}, {
  3.9061381004574547`*^9, 3.906138118391609*^9}, {3.906138163501085*^9, 
  3.9061382025088854`*^9}, {3.906138308991869*^9, 3.9061383752037635`*^9}, {
  3.906365586213606*^9, 3.9063656090415096`*^9}, {3.906367440449896*^9, 
  3.9063675963704195`*^9}, {3.906368089406643*^9, 3.9063680907844687`*^9}, {
  3.9063681885995984`*^9, 3.9063681939852867`*^9}, {3.9063691749585*^9, 
  3.906369175370818*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"3263382f-7d59-4672-91d5-01095e16560a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Questa", " ", "procedura", " ", "verifica", " ", "le", " ", "12", " ", 
   "equazioni", " ", "per", " ", "parametrizzare", " ", "le", " ", "matrici", 
   " ", "Rx", " ", "Ry", " ", "Rz", " ", "con", " ", "gli", " ", "angoli", 
   " ", "di", " ", "eulero"}], "*)"}]], "Input",
 CellChangeTimes->{{3.91205878649123*^9, 3.91205878868904*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"ba87c365-2395-4812-8c68-612830bc5903"],

Cell[BoxData[
 RowBox[{
  RowBox[{"EulerAnglesVerify", "[", "\[Gamma]\[Gamma]_", "]"}], " ", ":=", 
  " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "i", ",", "j", ",", "k", ",", "\[IndentingNewLine]", "sign", ",", 
      "options", ",", " ", "residualOptions", ",", "\[IndentingNewLine]", 
      "opt1", ",", "opt2", ",", "opt3", ",", "\[IndentingNewLine]", "R", ",", 
      "M1", ",", "M2", ",", "\[IndentingNewLine]", "res1", ",", " ", "res2", 
      ",", "\[IndentingNewLine]", "\[Gamma]"}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"ListQ", "[", "\[Gamma]\[Gamma]", "]"}], ",", " ", 
      RowBox[{
      "Print", "[", "\"\<The argument must be a scalar or symbol\>\"", " ", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"options", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", " ", "\"\<y\>\"", ",", " ", "\"\<z\>\""}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sign", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"\"\<+\>\"", ",", "\"\<-\>\""}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", "=", 
        RowBox[{"Rationalize", "[", "\[Gamma]\[Gamma]", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"opt1", " ", "=", " ", 
           RowBox[{"options", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"R", " ", "=", " ", 
           RowBox[{"RR", "[", 
            RowBox[{"opt1", ",", "\[Gamma]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"residualOptions", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"options", ",", " ", 
             RowBox[{"options", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"opt2", "=", 
              RowBox[{"residualOptions", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"opt3", "=", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"residualOptions", ",", "opt2"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"Do", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"M1", "=", 
                 RowBox[{"EulerAngle", "[", 
                  RowBox[{"opt2", ",", "opt3", ",", "\"\<1\>\"", ",", 
                   RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\[Gamma]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"M2", "=", 
                 RowBox[{"EulerAngle", "[", 
                  RowBox[{"opt2", ",", "opt3", ",", "\"\<2\>\"", ",", 
                   RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\[Gamma]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                
                RowBox[{"res1", "=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Expand", "[", 
                    RowBox[{"R", "-", "M1"}], "]"}], " ", "===", " ", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ")"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"res2", "=", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Expand", "[", 
                    RowBox[{"R", "-", "M2"}], "]"}], " ", "===", " ", 
                   RowBox[{"ConstantArray", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ")"}]}], ";", 
                "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"res1", "==", "True"}], ",", "\[IndentingNewLine]", 
                  
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "==", "\"\<+\>\""}], ",", 
                    " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<R\>\"", ",", "opt1", ",", "\"\<[\>\"", ",", 
                    "\[Gamma]", ",", "\"\<] = \>\"", ",", "\"\<R\>\"", ",", 
                    "opt2", ",", "\"\<[\>\"", ",", 
                    RowBox[{"Pi", "/", "2"}], ",", "\"\<]\>\"", ",", 
                    "\"\<R\>\"", ",", "opt3", ",", "\"\<[\>\"", ",", 
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\[Gamma]", ",", 
                    "\"\<]\>\"", ",", "\"\<R\>\"", ",", "opt2", ",", 
                    "\"\<[\>\"", ",", 
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", "\"\<]\>\""}], 
                    "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "==", "\"\<-\>\""}], ",", 
                    " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<R\>\"", ",", "opt1", ",", "\"\<[\>\"", ",", 
                    "\[Gamma]", ",", "\"\<] = \>\"", ",", "\"\<R\>\"", ",", 
                    "opt2", ",", "\"\<[\>\"", ",", 
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", "\"\<]\>\"", ",", 
                    "\"\<R\>\"", ",", "opt3", ",", "\"\<[\>\"", ",", 
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\[Gamma]", ",", 
                    "\"\<]\>\"", ",", "\"\<R\>\"", ",", "opt2", ",", 
                    "\"\<[\>\"", ",", 
                    RowBox[{"Pi", "/", "2"}], ",", "\"\<]\>\""}], "]"}]}], 
                    "]"}], ";"}], "\[IndentingNewLine]", ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"res2", "==", "True"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "==", "\"\<+\>\""}], ",", 
                    " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<R\>\"", ",", "opt1", ",", "\"\<[\>\"", ",", 
                    "\[Gamma]", ",", "\"\<] = \>\"", ",", "\"\<R\>\"", ",", 
                    "opt2", ",", "\"\<[\>\"", ",", 
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", "\"\<]\>\"", ",", 
                    "\"\<R\>\"", ",", "opt3", ",", "\"\<[\>\"", ",", 
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\[Gamma]", ",", 
                    "\"\<]\>\"", ",", "\"\<R\>\"", ",", "opt2", ",", 
                    "\"\<[\>\"", ",", 
                    RowBox[{"Pi", "/", "2"}], ",", "\"\<]\>\""}], "]"}]}], 
                    "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "==", "\"\<-\>\""}], ",", 
                    " ", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<R\>\"", ",", "opt1", ",", "\"\<[\>\"", ",", 
                    "\[Gamma]", ",", "\"\<] = \>\"", ",", "\"\<R\>\"", ",", 
                    "opt2", ",", "\"\<[\>\"", ",", 
                    RowBox[{"Pi", "/", "2"}], ",", "\"\<]\>\"", ",", 
                    "\"\<R\>\"", ",", "opt3", ",", "\"\<[\>\"", ",", 
                    RowBox[{"sign", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], ",", "\[Gamma]", ",", 
                    "\"\<]\>\"", ",", "\"\<R\>\"", ",", "opt2", ",", 
                    "\"\<[\>\"", ",", 
                    RowBox[{
                    RowBox[{"-", "Pi"}], "/", "2"}], ",", "\"\<]\>\""}], 
                    "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Return", "[", "False", "]"}]}], 
                    "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
               ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", 
                 RowBox[{"Length", "[", "sign", "]"}]}], "}"}]}], "]"}], 
             ";"}], "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{"Length", "[", "residualOptions", "]"}]}], "}"}]}], 
           "]"}], ";"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "options", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.906136951973987*^9, 3.9061369849456797`*^9}, {
   3.906137178679462*^9, 3.9061371791844726`*^9}, {3.906137212984271*^9, 
   3.906137217568159*^9}, {3.906137282514032*^9, 3.9061373174926386`*^9}, {
   3.906137430156578*^9, 3.9061374570235643`*^9}, {3.9061386048336697`*^9, 
   3.9061386158543024`*^9}, {3.9061386488049*^9, 3.906138810056407*^9}, {
   3.9061388419413013`*^9, 3.9061389849282246`*^9}, {3.906139288939741*^9, 
   3.90613941041469*^9}, {3.906139448103963*^9, 3.906139453388573*^9}, {
   3.9061395509051495`*^9, 3.9061395908411636`*^9}, {3.906139824891991*^9, 
   3.90613990633836*^9}, {3.9061399591402063`*^9, 3.906139987248371*^9}, {
   3.9061400178273306`*^9, 3.90614015323291*^9}, {3.9061401869672976`*^9, 
   3.906140371302038*^9}, {3.9061404065711308`*^9, 3.906140544362629*^9}, {
   3.9061406514854884`*^9, 3.9061406980926304`*^9}, {3.906140795652806*^9, 
   3.9061408623459063`*^9}, {3.9061411152088423`*^9, 
   3.9061411162804017`*^9}, {3.9061412802629013`*^9, 3.906141296946748*^9}, {
   3.906141329686448*^9, 3.906141388880399*^9}, {3.906141476262566*^9, 
   3.906141480661413*^9}, {3.9061415873078794`*^9, 3.9061416756598206`*^9}, 
   3.9061417223517942`*^9, {3.9061432272673826`*^9, 3.9061432278409405`*^9}, {
   3.9061432583913903`*^9, 3.9061432605666637`*^9}, {3.906143306323744*^9, 
   3.906143310731927*^9}, {3.9061433530594683`*^9, 3.90614338036613*^9}, {
   3.9061434607177687`*^9, 3.9061435478357873`*^9}, {3.9061437147391553`*^9, 
   3.906143825527693*^9}, {3.906176929669298*^9, 3.9061769530569787`*^9}, {
   3.9063656464003596`*^9, 3.9063656781445436`*^9}, {3.9063669658603945`*^9, 
   3.906367005630872*^9}, {3.906367085692644*^9, 3.9063673628197985`*^9}, {
   3.906367616393711*^9, 3.906367647369497*^9}, {3.906367690363278*^9, 
   3.906367811710645*^9}, {3.906367892714466*^9, 3.9063679656319695`*^9}, {
   3.906368226708809*^9, 3.9063682483807726`*^9}, {3.9063684604165072`*^9, 
   3.906368494411253*^9}, {3.9063685569818*^9, 3.9063686425591803`*^9}, 
   3.9063686912949915`*^9, 3.907145404712547*^9, {3.907145469323569*^9, 
   3.907145519283388*^9}, {3.9071456117182865`*^9, 3.907145624854885*^9}, {
   3.9071458090656614`*^9, 3.907145859121337*^9}, {3.9071459184102764`*^9, 
   3.907145932942341*^9}, 3.9071459636400566`*^9, {3.907146064689739*^9, 
   3.907146150455695*^9}, {3.907146183794914*^9, 3.9071461950413523`*^9}, {
   3.907146238814851*^9, 3.907146372377615*^9}, {3.9136279015881696`*^9, 
   3.9136279108417883`*^9}, {3.9136279959723415`*^9, 3.9136280281683893`*^9}},
 
 CellLabel->"In[25]:=",ExpressionUUID->"a7a8cbab-c0c5-4b9a-a382-74b6e6e01ecb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Antisymmetric Matrix S(w):", "Section",
 CellChangeTimes->{{3.9063701939950094`*^9, 
  3.9063702343516965`*^9}},ExpressionUUID->"3fd0dad5-8c33-459c-99af-\
23be22ac74cc"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "Normalizza", " ", "un", " ", "vettore", " ", "senza", " ", "approsimare"}],
   " ", "*)"}]], "Input",
 CellChangeTimes->{{3.9136310127768927`*^9, 3.913631030849717*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"4242f150-a5b7-47aa-9bfa-7843ce82e606"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Normalizza", "[", "v_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vx", ",", "vy", ",", "vz", ",", "norma", ",", "vRazionalizzato", ",", 
      "vNormalizzato"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "v", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "v", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument must be a matrix 3x1\>\"", " ", "]"}],
         ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<must be a matrix 3x1 of scalr\>\"", " ", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<must be a matrix 3x1 of scalr\>\"", " ", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ListQ", "[", 
        RowBox[{
         RowBox[{"v", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<must be a matrix 3x1 of scalr\>\"", " ", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vx", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vy", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vz", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"v", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"vRazionalizzato", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "vx", "}"}], ",", 
        RowBox[{"{", "vy", "}"}], ",", 
        RowBox[{"{", "vz", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"norma", "=", 
      RowBox[{"Norm", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"norma", "===", "0"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The versor has not be null\>\"", " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"vNormalizzato", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "norma"}], ")"}], "*", "vRazionalizzato"}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9136309908911695`*^9, 3.9136310699930735`*^9}, {
  3.913631108077817*^9, 3.9136311726932526`*^9}, {3.9136312250227485`*^9, 
  3.9136315906763983`*^9}, {3.913631667971706*^9, 3.913631690031649*^9}, {
  3.9136317268107743`*^9, 3.913631733360297*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"539e0b04-bddf-4b3f-b649-48c0ad6cbdbd"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Matrice", " ", "antisimmetrica"}], ",", " ", 
   RowBox[{
   "prende", " ", "in", " ", "ingresso", " ", "un", " ", "vettore", " ", 
    "colonna", " ", "3", "x1", " ", "di", " ", "modulo", " ", "unitario"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.912059164562862*^9, 3.9120592079612293`*^9}, {
  3.9120592623850307`*^9, 3.912059267788596*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"601fba62-0d9c-4b38-bd2c-6711e757318d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SS", "[", "\[Omega]_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "\[Omega]", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "\[Omega]", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument must be a matrix 3x1\>\"", " ", "]"}],
         ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Norm", "[", "\[Omega]", "]"}], "-", "1"}], ")"}], "===", 
          "0"}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument must be a versor\>\"", " ", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]x", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]y", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]z", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "\[Omega]z"}], ",", "\[Omega]y"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Omega]z", ",", "0", ",", 
         RowBox[{"-", "\[Omega]x"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Omega]y"}], ",", "\[Omega]x", ",", "0"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9063702396401787`*^9, 3.9063705198335547`*^9}, {
   3.9063705915549498`*^9, 3.906370626339566*^9}, 3.906370799416994*^9, 
   3.906372003772602*^9, 3.906372063626872*^9, {3.9136299381481843`*^9, 
   3.9136299578257103`*^9}, {3.913630278529163*^9, 3.913630288580939*^9}, {
   3.9136304069272437`*^9, 3.9136304279152946`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"0625c506-e8b9-404b-8b18-3a5dd2741cf6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Come", " ", "la", " ", "procedura", " ", "precedente", " ", "con", " ", 
   "la", " ", "differenza", " ", "che", " ", "non", " ", "richoede", " ", 
   "il", " ", "vincolo", " ", "che", " ", "\[Omega]", " ", "sia", " ", "un", 
   " ", "versore"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9120592221467*^9, 3.912059257322425*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"01762346-bb49-4779-8818-ea08463a58f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SS2", "[", "\[Omega]_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Omega]x", ",", "\[Omega]y", ",", "\[Omega]z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "\[Omega]", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "\[Omega]", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument must be a matrix 3x1\>\"", " ", "]"}],
         ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]x", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]y", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]z", "=", 
      RowBox[{"Rationalize", "[", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "\[Omega]z"}], ",", "\[Omega]y"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Omega]z", ",", "0", ",", 
         RowBox[{"-", "\[Omega]x"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "\[Omega]y"}], ",", "\[Omega]x", ",", "0"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9071504398296547`*^9, 3.907150466473857*^9}, 
   3.913630077012818*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"76d32a94-d964-48ac-8f68-34bbc02fcdfc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotation Matrix around Versor:", "Section",
 CellChangeTimes->{{3.9063687458696547`*^9, 3.9063687885790887`*^9}, {
   3.906368841494338*^9, 3.9063688546630335`*^9}, 
   3.90637023632804*^9},ExpressionUUID->"4d202cee-5d4d-4761-94cc-\
9a877b4cb9be"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Ritorna", " ", "una", " ", "matrice", " ", "di", " ", "rotazione", " ", 
   "di", " ", "angolo", " ", "\[Theta]", " ", "lungo", " ", "un", " ", "asse",
    " ", "identificato", " ", "da", " ", "un", " ", "versore", " ", "v", " ", 
   "di", " ", "dimensione", " ", "3", "x1", "\[IndentingNewLine]", "Per", " ",
    "calcolare", " ", "la", " ", "matrice", " ", "usiamo", " ", "Laplace"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9120592803715982`*^9, 3.912059339304434*^9}, {
  3.9120594397551928`*^9, 3.912059455836679*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"6674d767-7c3e-4406-999c-06c5bbb6b854"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Rv", "[", 
   RowBox[{"\[Theta]_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "S", ",", "A", ",", "RR", ",", ",", "\[Alpha]", ",", "s", ",", "t"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Controllo", " ", "i", " ", "parametri"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "v", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "v", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 2 must be a matrix 3x1\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Norm", "[", "v", "]"}], "-", "1"}], ")"}], "===", "0"}], 
         ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 2 must be a versor\>\"", " ", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Razionalaizzo", " ", "\[Theta]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"Rationalize", "[", "\[Theta]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "la", " ", "matrice", " ", "antisimmetrica"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"SS", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Trasformata", " ", "di", " ", "Laplace", " ", "per", " ", "la", " ", 
       "matrice", " ", "esponenziale"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"A", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"s", "*", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "-", "S"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Antitrasformata", " ", "di", " ", "Laplace"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"RR", " ", "=", 
      RowBox[{"InverseLaplaceTransform", "[", 
       RowBox[{"A", ",", "s", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RR", " ", "=", " ", 
      RowBox[{"RR", "/.", 
       RowBox[{"t", "->", "\[Alpha]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", "RR", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9063688625796423`*^9, 3.90636887202192*^9}, {
   3.906368914794377*^9, 3.9063690205568423`*^9}, {3.9063691005639524`*^9, 
   3.9063692503938*^9}, 3.9063693124570723`*^9, {3.906369480709858*^9, 
   3.9063696601708136`*^9}, {3.9063697069875555`*^9, 
   3.9063697268774786`*^9}, {3.9063699732601457`*^9, 
   3.9063700396459246`*^9}, {3.906370308213194*^9, 3.906370327246991*^9}, {
   3.9063706489870253`*^9, 3.9063707037294283`*^9}, 3.9063708170873594`*^9, {
   3.9063709426903443`*^9, 3.9063710727892475`*^9}, {3.90637111927864*^9, 
   3.9063712126726737`*^9}, {3.9063713175553837`*^9, 
   3.9063713212520294`*^9}, {3.906371353674959*^9, 3.9063713680275373`*^9}, {
   3.9066031093081493`*^9, 3.9066031637066784`*^9}, 3.906874065455593*^9, {
   3.906874294974905*^9, 3.9068743782780285`*^9}, {3.90687503909268*^9, 
   3.9068750394926786`*^9}, {3.9068787245859385`*^9, 3.906878728795354*^9}, 
   3.9068794126469507`*^9, 3.9071515319291735`*^9, {3.9136307317536507`*^9, 
   3.9136307336588964`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"089ff342-ab3d-4e92-84e8-18beb7616f6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rodriguez:", "Section",
 CellChangeTimes->{{3.90687474983533*^9, 
  3.906874757536533*^9}},ExpressionUUID->"04e4365a-4c74-4fec-9c08-\
24152d272ced"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Ritorna", " ", "una", " ", "matrice", " ", "di", " ", "rotazione", " ", 
   "di", " ", "angolo", " ", "\[Theta]", " ", "lungo", " ", "un", " ", "asse",
    " ", "identificato", " ", "da", " ", "un", " ", "versore", " ", "v", " ", 
   "di", " ", "dimensione", " ", "3", "x1", "\[IndentingNewLine]", "Per", " ",
    "calcolare", " ", "la", " ", "matrice", " ", "usiamo", " ", "la", " ", 
   "procedura", " ", "di", " ", "Rodriguez"}], "*)"}]], "Input",
 CellChangeTimes->{{3.912059388228397*^9, 3.912059391430216*^9}, {
  3.912059462992777*^9, 3.912059478419589*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"6b7b6844-3303-41ef-8dd5-9cab5d4d0deb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RodriguezDiretta", "[", 
   RowBox[{"\[Theta]_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S", ",", "R", ",", "\[Alpha]"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Controllo", " ", "i", " ", "parametri"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "v", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "v", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 2 must be a matrix 3x1\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "v", "]"}], "!=", "1"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 2 must be a versor\>\"", " ", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Razionalaizzo", " ", "\[Theta]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"Rationalize", "[", "\[Theta]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "la", " ", "matrice", " ", "antisimmetrica"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"SS", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calcolo", " ", "la", " ", "matrice", " ", "di", " ", "rotazione", " ", 
       "tramite", " ", "formula", " ", "di", " ", "Rodrigues"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"R", "=", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
       RowBox[{
        RowBox[{"MatrixPower", "[", 
         RowBox[{"S", ",", "2"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ")"}]}], "+", 
       RowBox[{"S", "*", 
        RowBox[{"Sin", "[", "\[Alpha]", "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", "R", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9063724652847357`*^9, 3.9063725008474827`*^9}, {
   3.906372549049589*^9, 3.90637258096914*^9}, 3.9063728515555267`*^9, {
   3.906373103381965*^9, 3.906373169116274*^9}, {3.906373291786582*^9, 
   3.906373326781819*^9}, {3.9066029600953083`*^9, 3.906603004896741*^9}, {
   3.9068739848331027`*^9, 3.9068739982852736`*^9}, {3.906874067864064*^9, 
   3.9068741032608795`*^9}, {3.9068741938803635`*^9, 3.906874236921526*^9}, {
   3.906875029806781*^9, 3.906875034481891*^9}, {3.906879421991999*^9, 
   3.9068794344329605`*^9}, {3.907151445732014*^9, 3.907151463748219*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"f8d36ff1-ff5c-45c9-93a3-9328417e0894"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Data", " ", "una", " ", "matrice", " ", "di", " ", "rotazione", " ", 
   "ritorna", " ", 
   RowBox[{"all", "'"}], "asse", " ", "di", " ", "rotazione", " ", 
   "normalizzato", " ", "e", " ", 
   RowBox[{"l", "'"}], "angolo", " ", "di", " ", "rotazione", 
   "\[IndentingNewLine]", "Ritorna", " ", "una", " ", "lista", " ", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", " ", "v"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.9120596513283043`*^9, 3.912059723965549*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"0cbe1306-08c3-46af-bf91-e40e4ab669a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RodriguezInversa", "[", "R_", "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "check", ",", "M1", ",", "M2", ",", "I", ",", "v", ",", "s", ",", "c", 
      ",", "exit", ",", "i", ",", "j", ",", "h", ",", "k", ",", "\[Theta]"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"check", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatrixQ", "[", "R", "]"}], "&&", 
        RowBox[{
         RowBox[{"Dimensions", "[", "R", "]"}], "==", 
         RowBox[{"{", 
          RowBox[{"3", ",", "3"}], "}"}]}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"check", "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The R dimensions are incorrect\>\"", " ", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Verifico", " ", "che", " ", "R", " ", "sia", " ", "una", " ", 
       "matrice", " ", "di", " ", "rotazione"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Simplify", "[", 
           RowBox[{"Det", "[", "R", "]"}], "]"}], "===", "1"}], ")"}], "==", 
        "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument R is not a rotation matrix\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M1", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"R", ".", 
        RowBox[{"Transpose", "[", "R", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"I", " ", "=", 
      RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"check", "=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Expand", "[", 
         RowBox[{"M1", "-", "I"}], "]"}], " ", "===", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"check", "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument R is not a rotation matrix\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "v"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M1", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"R", "-", "I"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"NullSpace", "[", "M1", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"v", " ", "=", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "v", "]"}], "/", 
        RowBox[{"Norm", "[", "v", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "matrici", " ", "per", " ", "il", " ", "seno"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M1", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"R", "-", 
        RowBox[{"Transpose", "[", "R", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M2", " ", "=", " ", 
      RowBox[{"SS", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "il", " ", "seno"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"exit", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"M2", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], "!=", "0"}], " ", "&&", 
            " ", 
            RowBox[{"exit", "!=", "True"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"exit", "=", "True"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"s", " ", "=", " ", 
             RowBox[{"Simplify", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"M1", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "/", "2"}], ")"}], 
               "/", 
               RowBox[{"M2", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"MatrixForm", "[", "M1", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"MatrixForm", "[", "M2", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", "s", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "3"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calcolo", " ", "matrici", " ", "per", " ", "il", " ", "coseno"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"M1", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"R", "+", 
        RowBox[{"Transpose", "[", "R", "]"}], "-", 
        RowBox[{"2", "*", 
         RowBox[{"IdentityMatrix", "[", "3", "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M2", " ", "=", " ", 
      RowBox[{"MatrixPower", "[", 
       RowBox[{
        RowBox[{"SS", "[", "v", "]"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "il", " ", "coseno"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"exit", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"M2", "[", 
              RowBox[{"[", 
               RowBox[{"h", ",", "k"}], "]"}], "]"}], "!=", "0"}], " ", "&&", 
            " ", 
            RowBox[{"exit", "!=", "True"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"exit", "=", "True"}], ";", " ", "\[IndentingNewLine]", 
            RowBox[{"c", " ", "=", " ", 
             RowBox[{"Simplify", "[", 
              RowBox[{"1", "-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"M1", "[", 
                    RowBox[{"[", 
                    RowBox[{"h", ",", "k"}], "]"}], "]"}], "/", "2"}], ")"}], 
                 "/", 
                 RowBox[{"M2", "[", 
                  RowBox[{"[", 
                   RowBox[{"h", ",", "k"}], "]"}], "]"}]}], ")"}]}], "]"}]}], 
            ";"}]}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"MatrixForm", "[", "M1", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"MatrixForm", "[", "M2", "]"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", "c", "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"h", ",", "3"}], "}"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "3"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "\[Theta]"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"c", ",", "s"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Theta]", ",", "v"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.906874948415878*^9, 3.9068749851296406`*^9}, {
   3.9068750817780347`*^9, 3.9068751312734995`*^9}, {3.906875190096382*^9, 
   3.9068753702093997`*^9}, {3.906875419556835*^9, 3.906875462385915*^9}, {
   3.9068756416359763`*^9, 3.9068756505229073`*^9}, {3.90687603943266*^9, 
   3.906876041441981*^9}, {3.9068761015136847`*^9, 3.9068761804282556`*^9}, {
   3.906876224482873*^9, 3.9068763380413322`*^9}, {3.9068763771770124`*^9, 
   3.9068764135452223`*^9}, {3.9068764652184925`*^9, 3.906876532971862*^9}, {
   3.906876604617589*^9, 3.9068766110827026`*^9}, {3.906876716211329*^9, 
   3.90687672423112*^9}, {3.9068768453929687`*^9, 3.9068769062484264`*^9}, 
   3.906876968038911*^9, {3.9068771930421114`*^9, 3.9068771934327745`*^9}, {
   3.906877270406911*^9, 3.9068773273643813`*^9}, {3.9068777074441857`*^9, 
   3.906877715886752*^9}, {3.906878848153643*^9, 3.906878903578825*^9}, {
   3.9068789413872895`*^9, 3.9068789501921773`*^9}, {3.9068791424171963`*^9, 
   3.9068791784705734`*^9}, {3.9068795539311357`*^9, 3.906879624424746*^9}, {
   3.90687966431766*^9, 3.906879817102132*^9}, {3.9068812539241753`*^9, 
   3.9068814712291203`*^9}, {3.90688152723587*^9, 3.9068815285194893`*^9}, {
   3.9068816148619657`*^9, 3.9068818398451786`*^9}, 3.906881873591647*^9, {
   3.9068819335041404`*^9, 3.9068822851073446`*^9}, 3.9068823848701143`*^9, {
   3.906882421137523*^9, 3.9068824336577663`*^9}, {3.906882489846442*^9, 
   3.9068825048324614`*^9}, 3.9068825398981047`*^9, {3.9068826251737175`*^9, 
   3.9068826797026415`*^9}, {3.9068827849746103`*^9, 
   3.9068828080630374`*^9}, {3.906882849582836*^9, 3.9068828552279277`*^9}, {
   3.906882903038066*^9, 3.9068829319438705`*^9}, {3.906883133991314*^9, 
   3.9068831489804745`*^9}, {3.906883192258746*^9, 3.9068832341401978`*^9}, {
   3.906883266111581*^9, 3.9068832963304253`*^9}, {3.906883359107298*^9, 
   3.9068833698030562`*^9}, {3.9068834058404903`*^9, 3.9068834803737097`*^9}, 
   3.9068835303180757`*^9, {3.9068836335315576`*^9, 3.9068836696911955`*^9}, {
   3.9068837147692523`*^9, 3.9068837232877445`*^9}, {3.9068838020853558`*^9, 
   3.9068839047560887`*^9}, {3.9068839701488476`*^9, 
   3.9068840648487816`*^9}, {3.9068841479834757`*^9, 3.9068842204973364`*^9}, 
   3.9068843211620207`*^9, {3.90688438626184*^9, 3.9068843897946663`*^9}, {
   3.906884432565049*^9, 3.9068844850579863`*^9}, {3.90688480669007*^9, 
   3.906884814308154*^9}, {3.9068848517489057`*^9, 3.9068848709590025`*^9}, {
   3.906884945036254*^9, 3.9068849453293695`*^9}, 3.9068850341019273`*^9, {
   3.907141528730296*^9, 3.9071415370567675`*^9}, {3.9071418813951583`*^9, 
   3.907141903666195*^9}, {3.907141993128549*^9, 3.90714199351716*^9}, {
   3.907142091716074*^9, 3.90714212410367*^9}, {3.907143445073343*^9, 
   3.9071434470212293`*^9}, {3.9071434833694215`*^9, 
   3.9071435144877567`*^9}, {3.907143764314697*^9, 3.907143771399587*^9}, {
   3.9071438312985735`*^9, 3.9071438444439692`*^9}, {3.9071438855418205`*^9, 
   3.9071438881425853`*^9}, {3.9071439710369744`*^9, 
   3.9071439769042463`*^9}, {3.9071443775395656`*^9, 
   3.9071443779194045`*^9}, {3.9071445501642685`*^9, 
   3.9071445794236946`*^9}, {3.907151470420844*^9, 3.907151473135603*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"b823e941-bb77-420a-b7dd-dabf1e44f1d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cayley:", "Section",
 CellChangeTimes->{{3.907148807356634*^9, 
  3.907148812073058*^9}},ExpressionUUID->"9742075c-8cfe-4c07-947d-\
e2c1a1b0df4b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Procedura", " ", "ausiliare", " ", "per", " ", "creare", " ", "un", " ", 
   "input", " ", "per", " ", "la", " ", "procedura", " ", "principlae", " ", 
   "che", " ", "nel", " ", "vettore", " ", "norma", "*", "v", " ", "contenga",
    " ", "le", " ", "info", " ", "di", " ", "\[Theta]", " ", "e", " ", "v"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.912059773440262*^9, 3.912059783920598*^9}, {
   3.9120598410577793`*^9, 3.912059885767993*^9}, 3.9136248915346327`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"a8648c76-10cd-4f0e-8d28-c308cf95f202"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CayleyInput", "[", 
   RowBox[{"\[Theta]_", ",", "v_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"norma", ",", "\[Alpha]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Controllo", " ", "i", " ", "parametri"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "v", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "v", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 2 must be a matrix 3x1\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Norm", "[", "v", "]"}], "!=", "1"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 2 must be a versor\>\"", " ", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Razionalizzo", " ", "\[Theta]"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"Rationalize", "[", "\[Theta]", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Calcolo", " ", "vettore"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"norma", " ", "=", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Alpha]", "]"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"Cos", "[", "\[Alpha]", "]"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"norma", "*", "v"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.9072507528071995`*^9, 3.907250783592717*^9}, {
  3.9072508137827644`*^9, 3.907251035159076*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"1376b9a1-ea8e-4e7e-bd05-07385552aa9c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Ritorna", " ", "una", " ", "matrice", " ", "di", " ", "rotazione", " ", 
   "di", " ", "angolo", " ", "\[Theta]", " ", "lungo", " ", "un", " ", "asse",
    " ", "identificato", " ", "da", " ", "un", " ", "versore", " ", "v", " ", 
   "di", " ", "dimensione", " ", "3", "x1", "\[IndentingNewLine]", "Per", " ",
    "calcolare", " ", "la", " ", "matrice", " ", "usiamo", " ", "la", " ", 
   "procedura", " ", "di", " ", "Cayley"}], "*)"}]], "Input",
 CellChangeTimes->{{3.912059937840705*^9, 3.912059939666955*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"bc673727-56ba-4bbf-b2a7-fba7a2b37741"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CayleyDiretta", "[", "w_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"check", ",", "I", ",", "S", ",", "M1", ",", "M2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"check", "=", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatrixQ", "[", "w", "]"}], "&&", 
        RowBox[{
         RowBox[{"Dimensions", "[", "w", "]"}], "==", 
         RowBox[{"{", 
          RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"check", "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The dimensions are incorrect\>\"", " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"I", "=", 
      RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", " ", "=", " ", 
      RowBox[{"SS2", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"M1", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"I", "-", "S"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"M2", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"I", "+", "S"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{"Det", "[", "M1", "]"}], "]"}], "===", "0"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<Det[I-S]=0 matrix is singular\>\"", " ", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "M1", "]"}], ".", 
       RowBox[{"(", "M2", ")"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.907150281482953*^9, 3.9071503371430073`*^9}, {
  3.907150782977258*^9, 3.9071508989455557`*^9}, {3.907150976793363*^9, 
  3.9071511769220715`*^9}, {3.907251180551157*^9, 3.9072512384399357`*^9}, {
  3.907474285535683*^9, 3.9074742925769706`*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"4533220b-394f-4837-864e-176faa31a77f"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Data", " ", "una", " ", "matrice", " ", "di", " ", "rotazione", " ", 
   "ritorna", " ", 
   RowBox[{"all", "'"}], "asse", " ", "di", " ", "rotazione", " ", 
   "normalizzato", " ", "e", " ", 
   RowBox[{"l", "'"}], "angolo", " ", "di", " ", "rotazione", 
   "\[IndentingNewLine]", "Ritorna", " ", "una", " ", "lista", " ", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", " ", "w"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.912059965570613*^9, 3.912059965977035*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"18fcdb66-3c0b-4e93-8108-05189671f28c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CayleyInversa", "[", "R_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "check", ",", "M1", ",", "I", ",", "S", ",", "\[Omega]x", ",", 
       "\[Omega]y", ",", "\[Omega]z", ",", "w", ",", "norma", ",", "eq1", ",",
        "eq2", ",", "c", ",", "s", ",", "sol", ",", "\[Theta]"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"check", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatrixQ", "[", "R", "]"}], "&&", 
         RowBox[{
          RowBox[{"Dimensions", "[", "R", "]"}], "==", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3"}], "}"}]}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"check", "==", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The R dimensions are incorrect\>\"", " ", "]"}], 
         ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Verifico", " ", "che", " ", "R", " ", "sia", " ", "una", " ", 
        "matrice", " ", "di", " ", "rotazione"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{"Det", "[", "R", "]"}], "]"}], "===", "1"}], ")"}], "==", 
         "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument R is not a rotation matrix\>\"", " ",
           "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"M1", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"R", ".", 
         RowBox[{"Transpose", "[", "R", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"I", " ", "=", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"check", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"M1", "-", "I"}], "]"}], " ", "===", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"check", "==", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument R is not a rotation matrix\>\"", " ",
           "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"I", "=", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{"Det", "[", 
           RowBox[{"R", "+", "I"}], "]"}], "]"}], "===", "0"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<Det[I-S]=0 matrix is singular\>\"", " ", "]"}], 
         ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"R", "-", "I"}], ")"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"R", "+", "I"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[Omega]x", " ", "=", " ", 
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"\[Omega]y", " ", "=", " ", 
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"\[Omega]z", " ", "=", " ", 
       RowBox[{"S", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"w", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "\[Omega]x", "}"}], ",", 
         RowBox[{"{", "\[Omega]y", "}"}], ",", 
         RowBox[{"{", "\[Omega]z", "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"norma", " ", "=", " ", 
       RowBox[{"Norm", "[", "w", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eq1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"norma", "*", "c"}], "-", "s"}], "==", 
        RowBox[{"-", "norma"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"eq2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "^", "2"}], "+", 
         RowBox[{"s", "^", "2"}]}], "==", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sol", "=", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"eq1", ",", "eq2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "s"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Reduce", "[", "]"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"c", "=", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"s", "=", 
       RowBox[{"sol", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"c", "===", 
         RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"c", "=", 
          RowBox[{"sol", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "1", ",", "2"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"s", "=", 
          RowBox[{"sol", "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"ArcTan", "[", 
         RowBox[{"c", ",", "s"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"w", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{"w", "/", "norma"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "w"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.907152294916356*^9, 3.9071523594690027`*^9}, {
  3.9071524455209846`*^9, 3.907152543412118*^9}, {3.907152603783922*^9, 
  3.907152797087202*^9}, {3.9072479363511324`*^9, 3.907247938267242*^9}, {
  3.9072480412577286`*^9, 3.90724806683387*^9}, {3.90724820769063*^9, 
  3.9072482773611135`*^9}, {3.907248330679971*^9, 3.9072483433986692`*^9}, {
  3.907250015013768*^9, 3.9072500214259987`*^9}, {3.9072500628801*^9, 
  3.907250099070775*^9}, {3.907250333503649*^9, 3.9072503359367743`*^9}, {
  3.9072503688655577`*^9, 3.907250377342618*^9}, {3.907252250587536*^9, 
  3.907252301350582*^9}, {3.907252426734332*^9, 3.9072524435366917`*^9}, {
  3.907902013040905*^9, 3.9079020434779863`*^9}, {3.907902286337367*^9, 
  3.907902308259059*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"616b8610-2ee5-4fc3-a42b-97d75be6b274"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Screw Matrix:", "Section",
 CellChangeTimes->{{3.907474208308815*^9, 
  3.9074742156688843`*^9}},ExpressionUUID->"90900b2e-3380-4ed8-8d4f-\
e2797d625409"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Ritorna", " ", "una", " ", "matrice", " ", "di", " ", "avvitamento", " ", 
   "di", " ", "angolo", " ", "\[Theta]", " ", "distanza", " ", "d", " ", "e", 
   " ", "asse", " ", "di", " ", "avvitamento", " ", "v"}], "*)"}]], "Input",
 CellChangeTimes->{{3.912059993671348*^9, 3.912060034256958*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"baee523c-a8fb-4c09-9e7c-919256ce9bc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScrewMatrix", "[", 
    RowBox[{"\[Theta]_", ",", "d_", ",", "v_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Rv\[Theta]", ",", "T", ",", "dv"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "d", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatrixQ", "[", "v", "]"}], "&&", 
           RowBox[{
            RowBox[{"Dimensions", "[", "v", "]"}], "==", 
            RowBox[{"{", 
             RowBox[{"3", ",", "1"}], "}"}]}]}], ")"}], "==", "False"}], ",", 
        
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 3 must be a matrix 3x1\>\"", " ", 
          "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Norm", "[", "v", "]"}], "!=", "1"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 3 must be a versor\>\"", " ", "]"}], 
         ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Calcolo", " ", 
        RowBox[{"Rv", "[", "\[Theta]", "]"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Rv\[Theta]", "=", 
       RowBox[{"RodriguezDiretta", "[", 
        RowBox[{"\[Theta]", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Copia", " ", "la", " ", "matrice", " ", "R1", " ", "in", " ", "R2", 
        " ", "nello", " ", "spazio", " ", "desiderato"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "=", "Rv\[Theta]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Finisco", " ", "di", " ", "comporre", " ", "la", " ", "matrice", " ", 
        "R"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"dv", "=", 
       RowBox[{"d", "*", "v"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", 
          RowBox[{"4", ";;", "4"}]}], "]"}], "]"}], "=", "dv"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "4"}], "]"}], "]"}], "=", "1"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"JOIN", "[", "]"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Ritorno", " ", "la", " ", "matrice"}], "*)"}], 
      "\[IndentingNewLine]", "T"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Matrice", " ", "avvitamento", " ", "lungo", " ", "x"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScrewMx", "[", 
    RowBox[{"\[Theta]_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "d", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Calcolo", " ", "la", " ", "matrice", " ", "di", " ", "avvitamento", 
        " ", "lungo", " ", "x"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ScrewMatrix", "[", 
       RowBox[{"\[Theta]", ",", "d", ",", "v"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Matrice", " ", "avvitamento", " ", "lungo", " ", "y"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScrewMy", "[", 
    RowBox[{"\[Theta]_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "d", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Calcolo", " ", "la", " ", "matrice", " ", "di", " ", "avvitamento", 
        " ", "lungo", " ", "y"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"v", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "0", "}"}], ",", 
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "0", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ScrewMatrix", "[", 
       RowBox[{"\[Theta]", ",", "d", ",", "v"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Matrice", " ", "avvitamento", " ", "lungo", " ", "z"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ScrewMz", "[", 
   RowBox[{"\[Theta]_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "[", "d", "]"}], "!=", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 1 must be a scalar or symbol\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calcolo", " ", "la", " ", "matrice", " ", "di", " ", "avvitamento", 
       " ", "lungo", " ", "z"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "0", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ScrewMatrix", "[", 
      RowBox[{"\[Theta]", ",", "d", ",", "v"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.9074742194271927`*^9, 3.907474264785756*^9}, 
   3.907474341057725*^9, {3.907474388035341*^9, 3.907474548484455*^9}, {
   3.9074748046214533`*^9, 3.9074748625461535`*^9}, {3.907474892950736*^9, 
   3.907474957425082*^9}, {3.9074754636452065`*^9, 3.9074754955418663`*^9}, {
   3.9074757795450196`*^9, 3.9074757944923415`*^9}, {3.9074758711443405`*^9, 
   3.9074759119046926`*^9}, {3.907475946964553*^9, 3.907476062306918*^9}, {
   3.907477733205793*^9, 3.9074777579916625`*^9}, {3.907478573431859*^9, 
   3.907478578656617*^9}, {3.90747871758311*^9, 3.9074787183659573`*^9}, {
   3.907903063797022*^9, 3.907903071815174*^9}, {3.912060047131117*^9, 
   3.912060082702203*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"015a9168-6c42-434b-baf1-88480d2f6000"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Funzioni ausiliarie per effettuare le sostituzioni:", "Section",
 CellChangeTimes->{{3.913881970116041*^9, 3.9138819957318993`*^9}, {
  3.913892658476479*^9, 
  3.913892661495523*^9}},ExpressionUUID->"069b5f0e-d67f-4af5-af80-\
b85a5650059b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
     "questo", " ", "funzione", " ", "produce", " ", "una", " ", "somma", " ",
       "di", " ", "simboli", " ", "q_inizio"}], " ", "+", " ", "q2", " ", 
     "+"}], " ", "..."}], " ", "+", " ", "qn"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9138840082400846`*^9, 3.913884037218938*^9}, {
  3.913886014399901*^9, 3.913886017108076*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"7d14ccf2-d17e-49be-9000-2823e17e12f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sommaSimbolica", "[", 
   RowBox[{"simbolo_", ",", "inizio_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "somma", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringQ", "[", "simbolo", "]"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<sommaSimbolica->input1: devi passare un simbolo\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "inizio", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"inizio", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<sommaSimbolica->input2: devi passare un numero >= 0\>\"", "]"}],
         ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<sommaSimbolica->input3: devi passare un numero >= 0\>\"", "]"}],
         ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inizio", ">", "n"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<sommaSimbolica->input2 e input3: deve essere inpunt2 < input3\>\
\"", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"somma", "=", 
      RowBox[{"Symbol", "[", 
       RowBox[{"simbolo", "<>", 
        RowBox[{"ToString", "[", "inizio", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"somma", "=", 
        RowBox[{"somma", "+", 
         RowBox[{"Symbol", "[", 
          RowBox[{"simbolo", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"inizio", "+", "1"}], ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "somma"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.913884046576871*^9, 3.913884054921042*^9}, {
  3.913885778269239*^9, 3.91388581310632*^9}, {3.9138858449546337`*^9, 
  3.913885884475986*^9}, {3.913885923400384*^9, 3.9138859236797657`*^9}, {
  3.913886722149734*^9, 3.913886750843693*^9}, {3.913886816422579*^9, 
  3.913886818027166*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"e82f3a0a-805b-4ba6-92f1-4ce563292a26"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"questo", " ", "funzione", " ", "produce", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"q_inizio", "+", "q2", "+"}], "..."}], "+", "qn"}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9138842105687447`*^9, 3.913884236736985*^9}, {
  3.9138860928171463`*^9, 3.913886094625628*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"7a294361-3957-4d64-b0e7-bbe1180caf73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CosSommaSimbolica", "[", 
   RowBox[{"simbolo_", ",", "inizio_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringQ", "[", "simbolo", "]"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<CosSommaSimbolica->input1: devi passare un simbolo\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "inizio", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"inizio", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<CosSommaSimbolica->input2: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<CosSommaSimbolica->input3: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inizio", ">", "n"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<CosSommaSimbolica->input2 e input3: deve essere inpunt2 < \
input3\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Cos", "[", 
      RowBox[{"sommaSimbolica", "[", 
       RowBox[{"simbolo", ",", "inizio", ",", "n"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9138842426032476`*^9, 3.9138842439012737`*^9}, {
  3.9138859532984467`*^9, 3.9138859707593813`*^9}, {3.913886042166574*^9, 
  3.913886044288526*^9}, {3.913886773489059*^9, 3.91388681094706*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"186361dc-1941-4bd9-b529-2b45998d43f6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"questo", " ", "funzione", " ", "produce", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"q_inizio", "+", "q2", "+"}], "..."}], "+", "qn"}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.913884303951818*^9, 3.913884304393073*^9}, {
  3.913886097810382*^9, 3.9138860994458027`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"2728142b-deb6-4bf8-a7bc-45f89ac21bef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SinSommaSimbolica", "[", 
   RowBox[{"simbolo_", ",", "inizio_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringQ", "[", "simbolo", "]"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SinSommaSimbolica->input1: devi passare un simbolo\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "inizio", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"inizio", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SinSommaSimbolica->input2: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SinSommaSimbolica->input3: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inizio", ">", "n"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SinSommaSimbolica->input2 e input3: deve essere inpunt2 < \
input3\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Sin", "[", 
      RowBox[{"sommaSimbolica", "[", 
       RowBox[{"simbolo", ",", "inizio", ",", "n"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913884248308056*^9, 3.913884268117347*^9}, {
  3.913886105185058*^9, 3.913886120358864*^9}, {3.913886842278615*^9, 
  3.9138868619081078`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"67ec7703-e631-403f-9062-2521f4ea6619"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"dato", " ", "n", " ", "crea", " ", "il", " ", "numero", " ", 
     RowBox[{"(", "inizio", ")"}], 
     RowBox[{"(", 
      RowBox[{"inizio", "+", "1"}], ")"}]}], "..."}], 
   RowBox[{"(", 
    RowBox[{"n", "-", "2"}], ")"}], 
   RowBox[{"(", 
    RowBox[{"n", "-", "1"}], ")"}], "n"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9138850295821857`*^9, 3.913885059707953*^9}, {
  3.913886161244844*^9, 3.913886180253373*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"00a70768-c7c8-4481-ab68-12ec13c2cd1e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"creaNumero", "[", 
   RowBox[{"inizio_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "inizio", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"inizio", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<creaNumero->input1: devi passare un numero >= 0\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<creaNumero->input2: devi passare un numero >= 0\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inizio", ">", "n"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<creaNumero->input1 e input2: deve essere inpunt2 < input3\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"FromDigits", "[", 
      RowBox[{"Range", "[", 
       RowBox[{"inizio", ",", "n"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.913885076960209*^9, 3.9138851118782597`*^9}, {
  3.9138862027150373`*^9, 3.91388624022066*^9}, {3.913887071691594*^9, 
  3.9138870836780357`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"32b5689e-b8c0-4f8f-9c0a-0bddddba303a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"sostituzione", " ", 
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"q_inizio", "+"}], "..."}], "+", "qn"}], "]"}]}], "->", 
   SubscriptBox["c", 
    RowBox[{
     RowBox[{"inizio", "..."}], "n"}]]}], "*)"}]], "Input",
 CellLabel->"In[57]:=",ExpressionUUID->"043a11d2-c284-4bfe-a773-76587a67d2bc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SostituzioneCos", "[", 
   RowBox[{"espressione_", ",", "inizio_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "esprSostituzioni", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "inizio", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"inizio", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneCos->input2: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneCos->input3: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inizio", ">", "n"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneCos->input2 e input3: deve essere inpunt2 < \
input3\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"esprSostituzioni", "=", "espressione"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q_inizio", "+"}], "..."}], "+", "qn"}], "]"}]}], "->", 
       SubscriptBox["c", 
        RowBox[{
         RowBox[{"inizio", "..."}], "n"}]]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"esprSostituzioni", "=", 
      RowBox[{"esprSostituzioni", "/.", 
       RowBox[{
        RowBox[{"CosSommaSimbolica", "[", 
         RowBox[{"\"\<q\>\"", ",", "inizio", ",", "n"}], "]"}], "->", 
        RowBox[{"Subscript", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", "\"\<c\>\"", "]"}], ",", 
          RowBox[{"creaNumero", "[", 
           RowBox[{"inizio", ",", "n"}], "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"ritorno", " ", 
       RowBox[{"l", "'"}], "espressione", " ", "con", " ", "le", " ", 
       "sostituzioni"}], "*)"}], "\[IndentingNewLine]", 
     "esprSostituzioni"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913885469753014*^9, 3.9138856977255507`*^9}, {
  3.913885794491207*^9, 3.9138858034200974`*^9}, {3.913887099824224*^9, 
  3.913887118006978*^9}, {3.913887197488143*^9, 3.9138872247938833`*^9}, {
  3.913887715121478*^9, 3.913887722125084*^9}, {3.913888018037492*^9, 
  3.913888020420977*^9}, {3.913888082216283*^9, 3.913888087662126*^9}, {
  3.9138881326342583`*^9, 3.9138881607294283`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"658bb0a0-1184-45db-9628-c8f5668e529e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"sostituzione", " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"q_inizio", "+"}], "..."}], "+", "qn"}], "]"}]}], "->", 
   SubscriptBox["s", 
    RowBox[{
     RowBox[{"inizio", "..."}], "n"}]]}], "*)"}]], "Input",
 CellChangeTimes->{{3.913887516238801*^9, 3.913887520829692*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"8c5d753d-35fa-4156-bede-1671f85c8f0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SostituzioneSin", "[", 
   RowBox[{"espressione_", ",", "inizio_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "esprSostituzioni", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "inizio", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"inizio", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneCos->input2: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneCos->input3: devi passare un numero >= 0\>\"", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"inizio", ">", "n"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneCos->input2 e input3: deve essere inpunt2 < \
input3\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"esprSostituzioni", "=", "espressione"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"q_inizio", "+"}], "..."}], "+", "qn"}], "]"}]}], "->", 
       SubscriptBox["s", 
        RowBox[{
         RowBox[{"inizio", "..."}], "n"}]]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"esprSostituzioni", "=", 
      RowBox[{"esprSostituzioni", "/.", 
       RowBox[{
        RowBox[{"SinSommaSimbolica", "[", 
         RowBox[{"\"\<q\>\"", ",", "inizio", ",", "n"}], "]"}], "->", 
        RowBox[{"Subscript", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", "\"\<s\>\"", "]"}], ",", 
          RowBox[{"creaNumero", "[", 
           RowBox[{"inizio", ",", "n"}], "]"}]}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"ritorno", " ", 
       RowBox[{"l", "'"}], "espressione", " ", "con", " ", "le", " ", 
       "sostituzioni"}], "*)"}], "\[IndentingNewLine]", 
     "esprSostituzioni"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913887471528864*^9, 3.913887473129249*^9}, {
  3.9138875284315987`*^9, 3.9138875415057373`*^9}, {3.9138877686783133`*^9, 
  3.9138877722714376`*^9}, {3.913888177415663*^9, 3.913888187998577*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"c8e5c3d3-28d3-4a39-a295-b2cc5583112d"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"sostituzione", " ", "del", " ", "tipo", " ", "qi"}], "->", 
   SubscriptBox["q", "i"]}], "*)"}]], "Input",
 CellChangeTimes->{{3.913888987805685*^9, 3.91388898988444*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"b46bbafb-5010-4341-89af-5aec9df58643"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SostituzioneSingola", "[", 
   RowBox[{"espressione_", ",", "simbolo_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "esprSostituzioni", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"StringQ", "[", "simbolo", "]"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneSingola->input2: devi passare un simbolo in formato \
stringa\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<SostituzioneSingola->input3: devi passare un numero\>\"", "]"}],
         ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"esprSostituzioni", "=", "espressione"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"esprSostituzioni", "=", 
      RowBox[{"esprSostituzioni", "/.", 
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"simbolo", "<>", 
          RowBox[{"ToString", "[", "n", "]"}]}], "]"}], "->", 
        RowBox[{"Subscript", "[", 
         RowBox[{
          RowBox[{"Symbol", "[", "simbolo", "]"}], ",", "n"}], "]"}]}]}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"ritorno", " ", 
       RowBox[{"l", "'"}], "espressione", " ", "con", " ", "le", " ", 
       "sostituzioni"}], "*)"}], "\[IndentingNewLine]", 
     "esprSostituzioni"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913888841135263*^9, 3.9138889744539337`*^9}, {
  3.9138890435388603`*^9, 3.913889135377242*^9}, {3.913889306461787*^9, 
  3.913889319273513*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"fee92682-4d86-487f-8b04-f8bb8632ea0e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Sostituzione", "[", 
   RowBox[{"espressione_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "esprSostituzioni", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Sostituzione->input2: devi passare un numero >= 0\>\"", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"esprSostituzioni", "=", "espressione"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"qi", "+", 
            RowBox[{"q_", 
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}]}], "+"}], "..."}], "+", "qn"}], 
         "]"}]}], "->", 
       SubscriptBox["c", 
        RowBox[{
         RowBox[{"i", "..."}], "n"}]]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esprSostituzioni", "=", 
           RowBox[{"SostituzioneCos", "[", 
            RowBox[{"esprSostituzioni", ",", "i", ",", "j"}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"qi", "+", 
            RowBox[{"q_", 
             RowBox[{"(", 
              RowBox[{"i", "+", "1"}], ")"}]}], "+"}], "..."}], "+", "qn"}], 
         "]"}]}], "->", 
       SubscriptBox["c", 
        RowBox[{
         RowBox[{"i", "..."}], "n"}]]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"esprSostituzioni", "=", 
           RowBox[{"SostituzioneSin", "[", 
            RowBox[{"esprSostituzioni", ",", "i", ",", "j"}], "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "i", ",", "n"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "qi"}], "->", 
       SubscriptBox["q", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<q\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "vi"}], "->", 
       SubscriptBox["v", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<v\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "Di"}], "->", 
       SubscriptBox["D", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<D\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "di"}], "->", 
       SubscriptBox["d", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<d\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "Li"}], "->", 
       SubscriptBox["L", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<L\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "li"}], "->", 
       SubscriptBox["l", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<l\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "Mi"}], "->", 
       SubscriptBox["M", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<M\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"sostituzione", " ", "mi"}], "->", 
       SubscriptBox["m", "i"]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"esprSostituzioni", "=", 
        RowBox[{"SostituzioneSingola", "[", 
         RowBox[{"esprSostituzioni", ",", "\"\<m\>\"", ",", "i"}], "]"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"ritorno", " ", 
       RowBox[{"l", "'"}], "espressione", " ", "con", " ", "le", " ", 
       "sostituzioni"}], "*)"}], "\[IndentingNewLine]", 
     "esprSostituzioni"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913882003632341*^9, 3.9138820415730963`*^9}, {
   3.913882165184888*^9, 3.913882193029583*^9}, {3.913882319381212*^9, 
   3.913882321246125*^9}, {3.913882410433901*^9, 3.91388243903265*^9}, 
   3.913882473731509*^9, {3.913884321522684*^9, 3.91388461099807*^9}, {
   3.913884690588427*^9, 3.913884733964809*^9}, {3.913885160399403*^9, 
   3.9138851692873783`*^9}, {3.9138853068822317`*^9, 
   3.9138853563314247`*^9}, {3.913885388341941*^9, 3.913885431438833*^9}, 
   3.913885639772915*^9, {3.913887243148652*^9, 3.9138872440609837`*^9}, {
   3.913887296617365*^9, 3.913887409861302*^9}, {3.9138884720687017`*^9, 
   3.913888479743526*^9}, {3.91388856828688*^9, 3.913888617809227*^9}, {
   3.913888656312499*^9, 3.913888833992536*^9}, {3.913889157492691*^9, 
   3.913889226191011*^9}, {3.9138895088794003`*^9, 3.9138895670249166`*^9}, {
   3.913892786986408*^9, 3.913892892832696*^9}, {3.913892937917223*^9, 
   3.9138929658597393`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"f3b9b959-78af-4855-89c6-d437182af864"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Direct Kinematic by Denavit-Hartenberg Table:", "Section",
 CellChangeTimes->{{3.907476462901946*^9, 3.9074765353652143`*^9}, {
  3.90747657040886*^9, 
  3.9074765717875056`*^9}},ExpressionUUID->"0adc6fe7-eeb3-4dc4-b6a0-\
000a78ed2888"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Calcola", " ", "una", " ", "matrice", " ", "Q", " ", "del", " ", "cambio", 
   " ", "delle", " ", "coordinate", " ", "in", " ", "base", " ", "alla", " ", 
   "riga", " ", "della", " ", "tabella", " ", "di", " ", "DH", " ", 
   "passata"}], "*)"}]], "Input",
 CellChangeTimes->{{3.9132891979741325`*^9, 3.9132892581497946`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"b8b680fb-8486-4019-8a8a-24f37d69f1f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CalcolaQ", "[", "DHrow_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nRow", ",", "nCol", ",", "\[Theta]", ",", "d", ",", "\[Alpha]", ",", 
       "a"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nRow", "=", "1"}], ";", "\[IndentingNewLine]", 
      RowBox[{"nCol", "=", "4"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "=", 
       RowBox[{"DHrow", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"DHrow", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Alpha]", "=", 
       RowBox[{"DHrow", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       RowBox[{"DHrow", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ListQ", "[", "DHrow", "]"}], "&&", 
           RowBox[{
            RowBox[{"Length", "[", "DHrow", "]"}], "==", "nCol"}]}], ")"}], "==",
          "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<The argument must be a list 1x4\>\"", " ", "]"}], 
         ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "\[Theta]", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<The component 1 of table row must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "d", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<The component 2 of table row must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "\[Alpha]", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<The component 3 of table row must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListQ", "[", "a", "]"}], "!=", "False"}], ",", 
        RowBox[{
         RowBox[{
         "Print", "[", 
          "\"\<The component 4 of table row must be a scalar or symbol\>\"", 
          " ", "]"}], ";", 
         RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"Calcolo", " ", "Qi"}], "-", "1"}], ",", "i"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ScrewMz", "[", 
        RowBox[{"\[Theta]", ",", "d"}], "]"}], ".", 
       RowBox[{"ScrewMx", "[", 
        RowBox[{"\[Alpha]", ",", "a"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Calcola", " ", "la", " ", "matrice", " ", "Q", " ", "del", " ", "cambio", 
    " ", "delle", " ", "coordinate", " ", "dal", " ", "sistema", " ", "di", 
    " ", "riferimeto", " ", "0", " ", "al", " ", "sistema", " ", "di", " ", 
    "riferimento", " ", "n", " ", "in", " ", "vase", " ", "alla", " ", 
    "tabella", " ", "di", " ", "di", " ", "DH", " ", "passata"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalcolaQon", "[", "DHtable_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "nRow", ",", "\[IndentingNewLine]", "nCol", ",", "\[IndentingNewLine]", 
      "temp"}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nRow", "=", 
      RowBox[{"Length", "[", "DHtable", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nCol", "=", "4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"temp", "=", 
      RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "DHtable", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "DHtable", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"nRow", ",", "nCol"}], "}"}]}]}], ")"}], "==", "False"}], 
       ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument must be a matrix nx4\>\"", " ", "]"}],
         ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calcolo", " ", "la", " ", "matrice", " ", "Q", " ", "da", " ", "0", 
       " ", "a", " ", "n"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"temp", "=", 
        RowBox[{"Simplify", "[", 
         RowBox[{"temp", ".", 
          RowBox[{"CalcolaQ", "[", 
           RowBox[{"DHtable", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nRow"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Ritorno", " ", "la", " ", "matrice", " ", "finale"}], "*)"}], 
     "\[IndentingNewLine]", "temp"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.907476573986813*^9, 3.9074766411248045`*^9}, {
   3.907476680205118*^9, 3.907476704429039*^9}, {3.90747677949011*^9, 
   3.9074767894831505`*^9}, {3.9074768800984354`*^9, 
   3.9074770422854633`*^9}, {3.9074770961006594`*^9, 
   3.9074773618393517`*^9}, {3.907478401557724*^9, 3.9074784294026303`*^9}, {
   3.9074784850344195`*^9, 3.9074785080811424`*^9}, {3.907478540297366*^9, 
   3.907478546378048*^9}, {3.9074789894494762`*^9, 3.9074790410772715`*^9}, {
   3.907479221209776*^9, 3.9074792435808024`*^9}, {3.9074795001830735`*^9, 
   3.9074795102511096`*^9}, {3.907480099278326*^9, 3.9074800996317644`*^9}, {
   3.9074801415292797`*^9, 3.9074804172651896`*^9}, 3.907480497127782*^9, {
   3.90748127822291*^9, 3.9074813688417664`*^9}, {3.90748176174724*^9, 
   3.9074818029039836`*^9}, {3.90790287339554*^9, 3.9079029337867527`*^9}, {
   3.9080360882086782`*^9, 3.908036119529072*^9}, {3.908036697754427*^9, 
   3.9080367782873898`*^9}, {3.908036836608616*^9, 3.908037044272526*^9}, {
   3.9080370752854652`*^9, 3.908037169364163*^9}, {3.913289094256153*^9, 
   3.913289104150587*^9}, {3.9132891554004536`*^9, 3.913289181814722*^9}, {
   3.913289266410178*^9, 3.9132894555126762`*^9}, {3.913290024476544*^9, 
   3.91329014329562*^9}, {3.9132901805593815`*^9, 3.913290357965266*^9}, {
   3.9132908891498237`*^9, 3.9132909071226177`*^9}, {3.9132909527508154`*^9, 
   3.913291040446866*^9}, {3.913291222534399*^9, 3.913291293979972*^9}, {
   3.9132913582326612`*^9, 3.9132913620255117`*^9}, {3.913295297661377*^9, 
   3.913295298954499*^9}, {3.9132953324733973`*^9, 3.9132953340197353`*^9}, {
   3.913296342130873*^9, 3.9132963436340265`*^9}, {3.9132970443700542`*^9, 
   3.9132970463870993`*^9}, {3.913486928466948*^9, 3.913486932336043*^9}, {
   3.913486992748788*^9, 3.9134869937255917`*^9}, {3.9135416942629757`*^9, 
   3.913541699135038*^9}, {3.913541758955739*^9, 3.913541764958251*^9}, {
   3.913882388962432*^9, 3.913882395729743*^9}, {3.913889390451292*^9, 
   3.9138894660730143`*^9}, {3.913890888177639*^9, 3.913890906039736*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"c5b3b26b-ba71-4898-b21b-d51c8215da5e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9074773848155146`*^9, 3.907477429204859*^9}, {
   3.9074774622280416`*^9, 3.907477581300242*^9}, {3.907477617404769*^9, 
   3.907477660120816*^9}, {3.907477787839178*^9, 3.907477992341014*^9}, {
   3.907478269128406*^9, 3.9074782749431458`*^9}, {3.9074787645512304`*^9, 
   3.9074787831557093`*^9}, {3.9074788794438505`*^9, 3.9074788820348167`*^9}, 
   3.907478984499779*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"1175b9b5-dd42-4f8d-b2b9-a4292c1d0b46"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Jacobiano:", "Section",
 CellChangeTimes->{{3.9132863099710627`*^9, 
  3.9132863135838385`*^9}},ExpressionUUID->"711b8952-e457-4870-af14-\
cc87cf2f4025"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Jacobiano", "[", 
   RowBox[{"vector_", ",", "variables_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"row", ",", "col"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"row", "=", 
      RowBox[{"Length", "[", "vector", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"col", " ", "=", 
      RowBox[{"Length", "[", "variables", "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"row", "==", "3"}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 1 must be a vector 3 componets\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"col", ">", "0"}], ")"}], "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<The argument 2 must be a vector n(>0) componets\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"vector", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"variables", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "row"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "col"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.913286673727019*^9, 3.913286675613068*^9}, {
  3.913286834608672*^9, 3.913286835831636*^9}, {3.913287234525828*^9, 
  3.913287235728232*^9}, {3.913295595090393*^9, 3.9132956020396585`*^9}, {
  3.9133074256406517`*^9, 3.91330742911364*^9}, {3.913308413758597*^9, 
  3.9133084479668055`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"dd4f115e-8aa3-436b-a134-ee5647157597"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrice inerzie generalizzate (traslazione):", "Section",
 CellChangeTimes->{{3.913283733020313*^9, 
  3.913283782989197*^9}},ExpressionUUID->"9fcafe7d-2039-4464-9b43-\
56606603aa3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CalcolaBt", "[", 
   RowBox[{"Mass_", ",", "dd_", ",", "variables_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"Jt", ",", "B"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListQ", "[", "Mass", "]"}], "!=", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 1 must be a scalar\>\"", " ", "]"}], 
        ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "dd", "]"}], "==", "3"}], ")"}], "==", 
        "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", "\"\<The argument 2 must be a vector 3 componets\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "variables", "]"}], ">", "0"}], ")"}], "==", 
        "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<The argument 3 must be a vector n(>0) componets\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", "Calcoli", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Jt", " ", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Jacobiano", "[", 
        RowBox[{"dd", ",", "variables"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"B", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Mass", "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "Jt", "]"}], ".", "Jt"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Ritorno", " ", "B"}], "*)"}], "\[IndentingNewLine]", "B"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQHfDTp4RB463ji0dijSB6jeGuBSA6apvrUhB9hYdx
H4iuWmsIpjdVaR4C0Q51FadAdE5h02UQPcvyxBUQnbzp3CsQfWfzXTCtcen6
PyYgfTpUhokZRPNMMWIByd/vMwbRl45NsgLR58r5bUC0rpR9E4hOEfLtAtGL
Ehiug2g7sf23QfTqP526rED6l8MsMxC9r6+tD0TbVD+bAKJd+3n2swFppoQz
YJr/7OeLINoje9JDEC2+bU8SO8hdM1jTQLTq9UOK3EBa5qeCMojetyoggAdI
m93LB9MxV0rfqYL8u6z/PYh2To6bkgikg/o6poLomAzDWSC6/jXLQhD9RKX6
pprmW0ev/dPAdPAZp/cg+tmLbjBdv2/eFxDdNWHiVxANAOnhqf8=
  "],
 CellLabel->"In[69]:=",ExpressionUUID->"363a263e-5b17-4a24-8ae9-32883dd7746e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Matrice inerzie generalizzate (rotazione):", "Section",
 CellChangeTimes->{{3.913283733020313*^9, 3.913283782989197*^9}, {
  3.9133008429111967`*^9, 
  3.9133008456039076`*^9}},ExpressionUUID->"4f8b2a0a-57eb-4911-bde6-\
32ad27d4974d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssegnaII", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"II", ",", "J", ",", "x", ",", "y", ",", "z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"NumericQ", "[", "n", "]"}], "==", "False"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"n", "<=", "0"}], ")"}]}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<AssegnaII->input1: devi passare un numero >= 0\>\"", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"inizializzazione", " ", "variabili"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"II", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"J", "=", 
      RowBox[{"Symbol", "[", "\"\<J\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Symbol", "[", "\"\<x\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Symbol", "[", "\"\<y\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z", "=", 
      RowBox[{"Symbol", "[", "\"\<z\>\"", "]"}]}], ";", "\n", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Matrice", " ", "simbolica", " ", "II"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"II", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "=", 
      SubscriptBox["J", 
       RowBox[{"x", ",", "n"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"II", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], "=", 
      SubscriptBox["J", 
       RowBox[{"y", ",", "n"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"II", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}], "=", 
      SubscriptBox["J", 
       RowBox[{"z", ",", "n"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Ritorno", " ", "la", " ", "matrice", " ", "simbolica", " ", "II"}], 
      "*)"}], "\[IndentingNewLine]", "II"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.913362109407146*^9, 3.913362145025119*^9}, {
   3.913362238459474*^9, 3.91336229890656*^9}, {3.913362558262095*^9, 
   3.913362559137298*^9}, {3.913362622752948*^9, 3.913362623370983*^9}, {
   3.913362722971878*^9, 3.9133627242783947`*^9}, {3.913363008855837*^9, 
   3.913363012326477*^9}, {3.913363349768189*^9, 3.913363360491192*^9}, {
   3.913376501062964*^9, 3.913376502230644*^9}, 3.913484498905177*^9, {
   3.9134941969296217`*^9, 3.913494261621439*^9}, {3.91349430975823*^9, 
   3.913494442524404*^9}, 3.9134946180236063`*^9, {3.913716622416646*^9, 
   3.913716629180921*^9}, {3.9137167433569803`*^9, 3.913716744316975*^9}, {
   3.913721385452745*^9, 3.9137213897613907`*^9}, {3.913889723432898*^9, 
   3.913889755669943*^9}, {3.913889834911894*^9, 3.9138898606232653`*^9}, {
   3.9138898995733*^9, 3.9138899662573442`*^9}, {3.913890078675953*^9, 
   3.913890088111703*^9}, {3.913890241151601*^9, 3.913890255050242*^9}, {
   3.913890331740128*^9, 3.913890342241126*^9}, {3.913890420548736*^9, 
   3.913890466390534*^9}, {3.913890502239957*^9, 3.913890535902424*^9}, {
   3.9138906372913237`*^9, 3.913890649705163*^9}, {3.913950644345693*^9, 
   3.91395065747711*^9}, {3.9139506948814173`*^9, 3.913950733658698*^9}, {
   3.913950773611782*^9, 3.913950775198957*^9}, {3.913950811235798*^9, 
   3.9139508538694696`*^9}, {3.9139509045879374`*^9, 3.913950904588266*^9}, {
   3.913950974316971*^9, 3.91395102971848*^9}, {3.913951104315832*^9, 
   3.9139512293229227`*^9}, {3.913951787075809*^9, 3.913951867647541*^9}, {
   3.913951940919582*^9, 3.913952135193206*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"baebf980-f365-4895-9812-82795b7dd488"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CalcolaBr", "[", 
   RowBox[{"R_", ",", "variables_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dotR", ",", "Rt", ",", "v", ",", "n", ",", "S", ",", "wx", ",", "wy", 
      ",", "wz", ",", "w", ",", "Jw", ",", "Jwt", ",", "II", ",", "B"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "variables", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<v\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{"v", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"v1", ",", "v2", ",", "...", ",", "vn"}], "}"}]}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Derivata", " ", "matrice", " ", "R"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"dotR", "=", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"R", ",", 
         RowBox[{"{", "variables", "}"}]}], "]"}], ".", "v"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Calcolo", " ", "relativa", " ", "matrice", " ", "antisimmetrica"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Rt", "=", 
      RowBox[{"Transpose", "[", "R", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"dotR", ".", "Rt"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Ricavo", " ", "vettore", " ", "w"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"wx", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wy", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"wz", "=", 
      RowBox[{
       RowBox[{"S", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"w", "=", 
      RowBox[{"{", 
       RowBox[{"wx", ",", "wy", ",", "wz"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"calcolo", " ", "Jw"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Jw", "=", 
      RowBox[{"Jacobiano", "[", 
       RowBox[{"w", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jwt", "=", 
      RowBox[{"Transpose", "[", "Jw", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"calcolo", " ", "B"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"II", "=", 
      RowBox[{"AssegnaII", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B", "=", " ", 
      RowBox[{"Simplify", "[", 
       RowBox[{"Jwt", ".", "R", ".", "II", ".", "Rt", ".", "Jw"}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Ritorno", " ", "B"}], "*)"}], "\[IndentingNewLine]", "B"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.913300857201418*^9, 3.913300873369508*^9}, {
   3.913307505195606*^9, 3.9133078743671064`*^9}, {3.913307910233903*^9, 
   3.913307955576565*^9}, {3.9133084531030207`*^9, 3.9133084606665344`*^9}, {
   3.9133085201852274`*^9, 3.913308527404919*^9}, 3.9133085958145475`*^9, {
   3.9133091629878163`*^9, 3.913309223782841*^9}, {3.91330933904368*^9, 
   3.9133093442357936`*^9}, {3.9133093767453375`*^9, 3.913309474074947*^9}, {
   3.9133095042538323`*^9, 3.913309590720068*^9}, {3.9133096481033955`*^9, 
   3.9133096488540764`*^9}, {3.913309975747344*^9, 3.913309976409909*^9}, {
   3.9133106114228363`*^9, 3.913310646121524*^9}, {3.913361942496933*^9, 
   3.9133619429107323`*^9}, {3.9133623116134567`*^9, 
   3.9133623365382957`*^9}, {3.91336270023507*^9, 3.9133627104667253`*^9}, {
   3.913485588283375*^9, 3.913485618301132*^9}, {3.913494503174077*^9, 
   3.913494508960133*^9}, {3.9134945431620483`*^9, 3.91349454732286*^9}, {
   3.9135786615863404`*^9, 3.9135787059009485`*^9}, 3.9135787767703786`*^9, {
   3.913578952898398*^9, 3.9135789537910805`*^9}, 3.913716634166231*^9, {
   3.913716697828915*^9, 3.913716730578061*^9}, {3.913890700675194*^9, 
   3.9138907042839727`*^9}, {3.9138907956020107`*^9, 3.913890801885116*^9}, {
   3.913890920054922*^9, 3.913890920641632*^9}, {3.913891168825884*^9, 
   3.913891193114197*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"7f613095-eb7c-451e-97f4-673aab9f196e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cambio coordinate baricentro:", "Section",
 CellChangeTimes->{{3.9139541937261133`*^9, 
  3.9139542145236397`*^9}},ExpressionUUID->"a0eb1f69-e7ee-490f-be00-\
5ce61173ce38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CinematicaBaricentro", "[", "d_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "Q", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"verifico", " ", "i", " ", "parametri"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "d", "]"}], "===", "3"}], ")"}], "==", 
        "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<CinematicaBaricentro-> input 1: must be a vector 3 \
componets\>\"", " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Q", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "=", "d"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Ritorno", " ", "Q"}], "*)"}], "\[IndentingNewLine]", "Q"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9139542200005903`*^9, 3.913954281718514*^9}, {
   3.913954315851287*^9, 3.9139543822495613`*^9}, 3.9139544930703077`*^9, {
   3.913954554661746*^9, 3.913954622328754*^9}, {3.913954691263595*^9, 
   3.91395470647689*^9}, {3.913954751869072*^9, 3.913954752146454*^9}, {
   3.913954799240526*^9, 3.913954855866702*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"08851f03-4cdd-41b2-8230-f583d19dcc5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Procedura riassuntiva per le cinematiche:", "Section",
 CellChangeTimes->{{3.913368353994256*^9, 
  3.9133683697248707`*^9}},ExpressionUUID->"c3f3db05-349c-422f-80a1-\
e96221f87e80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProceduraFinale", "[", 
   RowBox[{"DHtable_", ",", "infoBaricentro_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"nRow", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"nRow", " ", "=", " ", 
         RowBox[{
          RowBox[{"numero", " ", "righe", " ", "tabella", " ", "DH"}], " ", 
          "=", " ", 
          RowBox[{
           RowBox[{"numero", " ", "DoF"}], " ", "->", " ", "q1"}]}]}], ",", 
        "q2", ",", "...", ",", "qnRow"}], "*)"}], "\[IndentingNewLine]", 
      "nCol", ",", 
      RowBox[{"(*", 
       RowBox[{"nCol", " ", "=", " ", 
        RowBox[{
         RowBox[{"numero", " ", "colonne", " ", "tabella", " ", "DH"}], " ", "->",
          " ", 
         RowBox[{"deve", " ", "essere", " ", "4"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "Qon", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "Matrice", " ", "cambio", " ", "coordinate", " ", "dal", " ", 
         "sistema", " ", "di", " ", "riferimento", " ", "0", " ", "a", " ", 
         "n"}], "=", "nRow"}], "*)"}], "\[IndentingNewLine]", "Ron", ",", 
      RowBox[{"(*", 
       RowBox[{
       "Matrice", " ", "di", " ", "rotazione", " ", "da", " ", "0", " ", "a", 
        " ", "n"}], "*)"}], "\[IndentingNewLine]", "don", ",", 
      RowBox[{"(*", 
       RowBox[{
       "Vettore", " ", "di", " ", "traslazione", " ", "da", " ", "0", " ", 
        "a", " ", "n"}], "*)"}], "\[IndentingNewLine]", "DHT", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["Q", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
         "Matrice", " ", "che", " ", "rappresenta", " ", "le", " ", "prime", 
          " ", "i", " ", "righe", " ", "della", " ", "tabella", " ", "di", 
          " ", "Denavit"}], "-", "Hartenberg"}]}], "*)"}], 
      "\[IndentingNewLine]", "Q", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["Q", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
         "Matrice", " ", "cambio", " ", "coordinate", " ", "dal", " ", 
          "sistema", " ", "di", " ", "riferimento", " ", "0", " ", "a", " ", 
          "i", " ", "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "R", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["R", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
         "Matrice", " ", "di", " ", "rotazione", " ", "dal", " ", "sistema", 
          " ", "di", " ", "riferimento", " ", "0", " ", "a", " ", "i", " ", 
          "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "d", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["d", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
         "Vettore", " ", "di", " ", "traslazione", " ", "dal", " ", "sistema",
           " ", "di", " ", "riferimento", " ", "0", " ", "a", " ", "i", " ", 
          "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "Qbaricentro", ",", "\[IndentingNewLine]", 
      "Rbaricentro", ",", "\[IndentingNewLine]", "dbaricentro", ",", 
      "\[IndentingNewLine]", "M", ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"M", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"M1", ",", "M2", ",", "..", ",", "Mn"}], "}"}]}], ",", " ", 
        
        RowBox[{
        "massa", " ", "di", " ", "ogni", " ", "link", " ", "stilizzato", " ", 
         "come", " ", "un", " ", "segmento", " ", "con", " ", 
         "densit\[AGrave]", " ", "uniforme"}]}], "*)"}], 
      "\[IndentingNewLine]", "q", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["q", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"q1", ",", "q2", ",", "...", ",", "qi"}], "}"}], " ", 
          "per", " ", "il", " ", "link", " ", "i", " ", "con", " ", "i"}], 
         "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "vv", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["vv", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"v1", ",", "v2", ",", "...", ",", "vi"}], "}"}], " ", 
          "per", " ", "il", " ", "link", " ", "i", " ", "con", " ", "i"}], 
         "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "Bt", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["Bt", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
         "Matrice", " ", "quadratica", " ", "delle", " ", "inerzia", " ", 
          RowBox[{"(", "traslazioni", ")"}], " ", "per", " ", "il", " ", 
          "link", " ", "i", " ", "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "Br", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["Br", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
         "Matrice", " ", "quadratica", " ", "delle", " ", "inerzia", " ", 
          RowBox[{"(", "rotazioni", ")"}], " ", "per", " ", "il", " ", "link",
           " ", "i", " ", "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "Btr", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["Br", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
         "Matrice", " ", "quadratica", " ", "delle", " ", "inerzia", " ", 
          RowBox[{"(", 
           RowBox[{"traslazioni", "-", "rotazioni"}], ")"}], " ", "per", " ", 
          "il", " ", "link", " ", "i", " ", "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}], "*)"}], 
      "\[IndentingNewLine]", "B", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["B", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["Bt", "i"], "+", 
          SubscriptBox["Br", "i"]}], " ", "=", " ", 
         RowBox[{
          RowBox[{
          "Matrice", " ", "quadratica", " ", "complessiva", " ", "delle", " ",
            "inerzia", " ", 
           RowBox[{"(", 
            RowBox[{"traslazioni", " ", "+", " ", "rotazioni"}], ")"}], " ", 
           "per", " ", "il", " ", "link", " ", "i", " ", "con", " ", "i"}], 
          "=", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "...", ",", "n"}], "}"}]}]}]}], "*)"}],
       "\[IndentingNewLine]", "T1", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["T1", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{"Energia", " ", "cinetica", " ", "relativa", " ", "a", " ", 
          SubscriptBox["Bt", "i"], " ", "per", " ", "il", " ", "link", " ", 
          "i", " ", "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", "T2", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["T2", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{"Energia", " ", "cinetica", " ", "relativa", " ", "a", " ", 
          SubscriptBox["Br", "i"], " ", "per", " ", "il", " ", "link", " ", 
          "i", " ", "con", " ", "i"}], "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", "T", ",", 
      RowBox[{"(*", 
       RowBox[{
        SubscriptBox["T", "i"], " ", "=", " ", 
        RowBox[{
         RowBox[{"Energia", " ", "cinetica", " ", "relativa", " ", "a", " ", 
          SubscriptBox["B", "i"], " ", "ovvero", " ", 
          RowBox[{"l", "'"}], "energia", " ", "cinetica", " ", "totale", " ", 
          "per", " ", "il", " ", "link", " ", "i", " ", "con", " ", "i"}], 
         "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "...", ",", "n"}]}]}]}], "*)"}], 
      "\[IndentingNewLine]", "Btot", ",", 
      RowBox[{"(*", 
       RowBox[{"Btot", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["B", "1"], "+", 
            SubscriptBox["B", "2"], "+"}], "..."}], "+", 
          SubscriptBox["B", "n"]}], " ", "->", " ", 
         RowBox[{
         "Forma", " ", "quadratica", " ", "inerzie", " ", "totale", " ", "di",
           " ", "tutto", " ", "il", " ", "robot", " ", "ovvero", " ", "di", 
          " ", "tutti", " ", "gli", " ", "n", " ", "link", " ", 
          "insieme"}]}]}], "*)"}], "\[IndentingNewLine]", "Ttot"}], 
     RowBox[{"(*", 
      RowBox[{"Ttot", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           SubscriptBox["T", "1"], "+", 
           SubscriptBox["T", "2"], "+"}], "..."}], "+", 
         SubscriptBox["T", "n"]}], " ", "->", " ", 
        RowBox[{
        "Energia", " ", "cinetica", " ", "totale", " ", "di", " ", "tutto", 
         " ", "il", " ", "robot", " ", "ovvero", " ", "di", " ", "tutti", " ",
          "gli", " ", "n", " ", "link", " ", "insieme"}]}]}], "*)"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nRow", "=", 
      RowBox[{"Length", "[", "DHtable", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nCol", "=", "4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ttot", "=", "0"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"M", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Symbol", "[", 
         RowBox[{"\"\<M\>\"", "<>", 
          RowBox[{"ToString", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "nRow"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Verifico", " ", "parametri"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatrixQ", "[", "DHtable", "]"}], "&&", 
          RowBox[{
           RowBox[{"Dimensions", "[", "DHtable", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"nRow", ",", "nCol"}], "}"}]}]}], ")"}], "==", "False"}], 
       ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<ProceduraFinale -> input 1: must be a matrix nx4\>\"", " ", 
         "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "infoBaricentro", "]"}], "===", "3"}], ")"}],
         "==", "False"}], ",", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<ProceduraFinale -> input 2: must be a vector 3 componets\>\"", 
         " ", "]"}], ";", 
        RowBox[{"Return", "[", "Null", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Tabella di Denavit-Hartenberg:\>\"", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"Sostituzione", "[", 
        RowBox[{"DHtable", ",", "nRow"}], "]"}], "]"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", "\"\<*******************************************\>\"", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Qon", "=", 
      RowBox[{"CalcolaQon", "[", "DHtable", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Cinematica Diretta:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Q[\>\"", ",", "nRow", ",", "\"\<]=\>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Sostituzione", "[", 
         RowBox[{"Qon", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Ron", "=", 
      RowBox[{"Qon", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", 
         RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Matrice di rotazione finale:\>\"", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<R=\>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Sostituzione", "[", 
         RowBox[{"Ron", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"don", "=", 
      RowBox[{"Qon", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<vettore traslazione finale:\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<d=\>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Sostituzione", "[", 
         RowBox[{"don", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<*******************\>\"", ",", "\"\<Link \>\"", ",", "i", ",", 
          "\"\<*******************\>\""}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Prime", " ", "i", " ", "righe", " ", "della", " ", "tabella", " ", 
           "di", " ", "Denavit"}], "-", 
          RowBox[{
          "Hartenberg", " ", "per", " ", "il", " ", "link", " ", "i"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"DHT", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{"DHtable", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Cinematica", " ", "diretta", " ", "in", " ", "accordo", " ", "con",
            " ", "Denavit"}], "-", 
          RowBox[{
          "Hartenberg", " ", "per", " ", "il", " ", "link", " ", "i"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Q", "=", 
         RowBox[{"CalcolaQon", "[", "DHT", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"Q", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Relativa", " ", "matrice", " ", "di", " ", "rotazione", " ", "in", 
           " ", "accordo", " ", "con", " ", "Denavit"}], "-", 
          RowBox[{
          "Hartenberg", " ", "per", " ", "il", " ", "link", " ", "i"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", 
            RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Matrice di rotazione da 0 a \>\"", ",", "i", ",", "\"\<:\>\""}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<R[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"R", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "Relativo", " ", "vettore", " ", "di", " ", "traslazione", " ", 
           "in", " ", "accordo", " ", "con", " ", "Denavit"}], "-", 
          RowBox[{
          "Hartenberg", " ", "per", " ", "il", " ", "link", " ", "i"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"Q", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<vettore traslazione da 0 a \>\"", ",", "i", ",", "\"\<:\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<d[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"d", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Cinematica", " ", "diretta", " ", "in", " ", "accordo", " ", "ad", 
          " ", "info", " ", "baricentro", " ", "per", " ", "il", " ", "link", 
          " ", "i"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Qbaricentro", "=", 
         RowBox[{"Q", ".", 
          RowBox[{"CinematicaBaricentro", "[", "infoBaricentro", "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Q_baricentro[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"Qbaricentro", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Relativa", " ", "matrice", " ", "di", " ", "rotazione", " ", "in", 
          " ", "accordo", " ", "ad", " ", "info", " ", "baricentro", " ", 
          "per", " ", "il", " ", "link", " ", "i"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Rbaricentro", "=", 
         RowBox[{"Qbaricentro", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", 
            RowBox[{"1", ";;", "3"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Matrice di rotazione da 0 a \>\"", ",", "i", ",", "\"\<:\>\""}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<R[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"R", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Relativo", " ", "vettore", " ", "di", " ", "traslazione", " ", "in",
           " ", "accordo", " ", "ad", " ", "info", " ", "baricentro", " ", 
          "per", " ", "il", " ", "link", " ", "i"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dbaricentro", "=", 
         RowBox[{"Qbaricentro", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<vettore traslazione da 0 a \>\"", ",", "i", ",", "\"\<:\>\""}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<d[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"d", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Variabili", " ", "di", " ", "giunto"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"q", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<q\>\"", "<>", 
             RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<q=\>\"", ",", "q"}], "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Velocit\[AGrave]", " ", "variabili", " ", "di", " ", "giunto"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"vv", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Symbol", "[", 
            RowBox[{"\"\<v\>\"", "<>", 
             RowBox[{"ToString", "[", "j", "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<v=\>\"", ",", "vv"}], "]"}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Forma", " ", "quadratica", " ", "eneriga", " ", "cinetica", " ", 
          "di", " ", "pura", " ", "rotazione", " ", "per", " ", "il", " ", 
          "link", " ", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Br", "=", 
         RowBox[{"CalcolaBr", "[", 
          RowBox[{"Rbaricentro", ",", "q"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Br[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"Br", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Enegia", " ", "cinetica", " ", "di", " ", "pura", " ", "rotazione", 
          " ", "per", " ", "il", " ", "link", " ", "i"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"T1", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "*", 
           RowBox[{
            RowBox[{"Transpose", "[", "vv", "]"}], ".", "Br", ".", "vv"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<T1[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"T1", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Forma", " ", "quadratica", " ", "eneriga", " ", "cinetica", " ", 
          "di", " ", "pura", " ", "traslazione", " ", "per", " ", "il", " ", 
          "link", " ", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Bt", "=", 
         RowBox[{"CalcolaBt", "[", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "dbaricentro", ",", "q"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Bt[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"Bt", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Enegia", " ", "cinetica", " ", "di", " ", "pura", " ", 
          "traslazione", " ", "per", " ", "il", " ", "link", " ", "i"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"T2", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"1", "/", "2"}], "*", 
           RowBox[{
            RowBox[{"Transpose", "[", "vv", "]"}], ".", "Bt", ".", "vv"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<T2[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"T2", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Forma", " ", "quadratica", " ", "complessiva", " ", "per", " ", 
          "il", " ", "link", " ", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"B", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Bt", "+", "Br"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<B[\>\"", ",", "i", ",", "\"\<]=Br[\>\"", ",", "i", ",", 
          "\"\<]+Bt[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"B", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Enegia", " ", "cinetica", " ", "complessiva", " ", "per", " ", "il",
           " ", "link", " ", "i"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"T", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"T1", "+", "T2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<T[\>\"", ",", "i", ",", "\"\<]=\>\"", ",", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"Sostituzione", "[", 
            RowBox[{"T", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Enegia", " ", "cinetica", " ", "totale", " ", "del", " ", "robot"}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Ttot", " ", "=", " ", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Ttot", "+", "T"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nRow"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<******************* Energia Cinetica Totale \
*******************\>\"", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Ttot=\>\"", ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"Sostituzione", "[", 
         RowBox[{"Ttot", ",", "nRow"}], "]"}], "]"}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9133683797057743`*^9, 3.9133684095077543`*^9}, 
   3.9133684457253838`*^9, {3.9133685173983927`*^9, 3.9133685815619307`*^9}, {
   3.913368612723928*^9, 3.9133687904349833`*^9}, {3.913368836825325*^9, 
   3.913368942542741*^9}, {3.913369037154323*^9, 3.913369192766011*^9}, {
   3.9133692302324533`*^9, 3.9133692558857813`*^9}, {3.913369338713696*^9, 
   3.913369339670426*^9}, {3.913369423509819*^9, 3.913369442347578*^9}, {
   3.9133695792226677`*^9, 3.913369597349414*^9}, {3.913369671840269*^9, 
   3.913369683670685*^9}, {3.9133697726096582`*^9, 3.913369843426784*^9}, {
   3.91336988626453*^9, 3.913369908578162*^9}, {3.913369958814682*^9, 
   3.913370003173736*^9}, {3.9133700609595957`*^9, 3.913370065482461*^9}, {
   3.913370107531583*^9, 3.9133702067101097`*^9}, 3.91337024136047*^9, {
   3.9133703234222317`*^9, 3.913370417847794*^9}, {3.913370487294026*^9, 
   3.913370494912395*^9}, {3.9133706200800133`*^9, 3.913370644084423*^9}, {
   3.913370677453126*^9, 3.9133708401010437`*^9}, {3.9133710056487083`*^9, 
   3.9133710095665903`*^9}, {3.9133711771828127`*^9, 
   3.9133713065745087`*^9}, {3.913371399175737*^9, 3.91337140194608*^9}, {
   3.913371504113964*^9, 3.913371507940139*^9}, {3.913371687989991*^9, 
   3.913371722241406*^9}, 3.913371843809822*^9, {3.913371951411552*^9, 
   3.913372023480418*^9}, {3.913372122572209*^9, 3.913372249863447*^9}, {
   3.913372290312058*^9, 3.913372290878765*^9}, {3.913372335892161*^9, 
   3.913372486028811*^9}, {3.9133725450813437`*^9, 3.913372616776651*^9}, {
   3.913483946964872*^9, 3.913483975965849*^9}, {3.9134840545992317`*^9, 
   3.913484091907942*^9}, {3.9134841574744*^9, 3.913484168115282*^9}, {
   3.9134857276315327`*^9, 3.913485774842553*^9}, {3.9134858610701103`*^9, 
   3.913485884932392*^9}, {3.913486089164694*^9, 3.913486089672179*^9}, {
   3.913487139458621*^9, 3.9134871495095587`*^9}, {3.913487209719048*^9, 
   3.913487261939967*^9}, {3.913487578334673*^9, 3.913487599414626*^9}, {
   3.913494690394526*^9, 3.9134946970540323`*^9}, {3.913494750930984*^9, 
   3.913494855313146*^9}, {3.913495083524935*^9, 3.913495258558405*^9}, {
   3.9134953044614353`*^9, 3.913495980879561*^9}, {3.913496011352027*^9, 
   3.913496052892201*^9}, {3.913496099513732*^9, 3.913496131634096*^9}, {
   3.91349626632098*^9, 3.9134963366052237`*^9}, {3.913496447682414*^9, 
   3.913496619895068*^9}, {3.9134966643283052`*^9, 3.913496696388205*^9}, {
   3.9135433298274484`*^9, 3.913543467166103*^9}, {3.9135435359554977`*^9, 
   3.9135435737050076`*^9}, {3.913543641541915*^9, 3.9135437022513905`*^9}, {
   3.9135437960064344`*^9, 3.913543909169876*^9}, {3.913544021326493*^9, 
   3.9135440491534433`*^9}, {3.9135764949904594`*^9, 3.913576512831608*^9}, {
   3.913576549867594*^9, 3.9135765670284414`*^9}, {3.9135766993293686`*^9, 
   3.913576780716281*^9}, {3.9135769009734464`*^9, 3.913576924267174*^9}, {
   3.913576955187873*^9, 3.9135770646839695`*^9}, {3.9135775320530663`*^9, 
   3.913577533809669*^9}, {3.9135775951929517`*^9, 3.9135776043566113`*^9}, {
   3.9135782922307615`*^9, 3.913578294306567*^9}, {3.9135784035543723`*^9, 
   3.913578409428234*^9}, {3.913578730351539*^9, 3.9135787554946003`*^9}, {
   3.9135787926714993`*^9, 3.913578827807677*^9}, 3.913578977514473*^9, {
   3.913583020879916*^9, 3.9135831264535737`*^9}, {3.913583255023254*^9, 
   3.9135832925456395`*^9}, {3.913583401737254*^9, 3.913583582851332*^9}, 
   3.9135838611649747`*^9, {3.913583962947939*^9, 3.913583968513769*^9}, {
   3.9136254112366714`*^9, 3.9136254255168095`*^9}, {3.9138909806306477`*^9, 
   3.913891036782146*^9}, {3.913891066822186*^9, 3.913891089559705*^9}, {
   3.9138911441368237`*^9, 3.913891151952118*^9}, {3.913891209968563*^9, 
   3.913891216967516*^9}, {3.913891252596072*^9, 3.913891316417605*^9}, {
   3.913891395855854*^9, 3.913891404239688*^9}, {3.913891453735681*^9, 
   3.913891456941536*^9}, {3.9138915103655024`*^9, 3.91389151085188*^9}, 
   3.913891618240632*^9, {3.913891666507444*^9, 3.9138916827818117`*^9}, {
   3.913891716128008*^9, 3.913891948518611*^9}, {3.913952415086122*^9, 
   3.913952899207199*^9}, {3.9139529851638737`*^9, 3.913952986179902*^9}, {
   3.91395390484085*^9, 3.913953923256875*^9}, {3.913953980353229*^9, 
   3.913954070047247*^9}, {3.913954131355875*^9, 3.913954149796918*^9}, {
   3.9139548736335278`*^9, 3.913954931144004*^9}, {3.9139550075460997`*^9, 
   3.913955227777268*^9}, {3.91395527920413*^9, 3.91395529173234*^9}, {
   3.91395540645153*^9, 3.913955408740041*^9}, {3.913955514806135*^9, 
   3.9139555179251747`*^9}, {3.9139561891780024`*^9, 3.91395619403941*^9}, {
   3.913956378229558*^9, 3.913956384105289*^9}, {3.9139564446755247`*^9, 
   3.9139564452063837`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"0e1966a2-3dfa-4171-aae5-8928c420b765"]
}, Open  ]]
},
WindowSize->{1710, 955},
WindowMargins->{{0, Automatic}, {Automatic, 5}},
DockedCells->{},
SpellingDictionaries->{"CorrectWords"->{"Questa"}},
Magnification:>1.5 Inherited,
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"605ea035-8eac-43af-9d25-f68eff40552e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 268, 4, 101, "Section",ExpressionUUID->"0748cad9-462a-47bd-b7c6-dd1609856232"],
Cell[851, 28, 383, 8, 46, "Input",ExpressionUUID->"0cf7fa7a-05de-4f71-89f7-00c3dcfdc597"],
Cell[1237, 38, 3949, 78, 419, "Input",ExpressionUUID->"6315e9fb-a5e0-45a2-b98d-d74e131bcbcb"],
Cell[5189, 118, 2796, 54, 357, "Input",ExpressionUUID->"18953c69-e734-4cae-b4f6-ab49558318cf"],
Cell[7988, 174, 2677, 52, 326, "Input",ExpressionUUID->"337d27a7-433c-4ffa-9c25-9961f48d1f32"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10702, 231, 324, 5, 101, "Section",ExpressionUUID->"62805a66-b370-40b1-bb49-59f4bd182fbb"],
Cell[11029, 238, 880, 19, 109, "Input",ExpressionUUID->"2c104067-a328-446c-ab80-0f68bdb3c1c3"],
Cell[11912, 259, 2699, 52, 357, "Input",ExpressionUUID->"0154067a-34a9-449f-8bf2-c78121950c6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14648, 316, 214, 4, 101, "Section",ExpressionUUID->"d287f03a-8d9d-4d47-ba9c-328093f2e42b"],
Cell[14865, 322, 793, 15, 78, "Input",ExpressionUUID->"48ae197c-4942-4ecf-b365-aac7f4a157b4"],
Cell[15661, 339, 3122, 67, 450, "Input",ExpressionUUID->"a575efd0-92d3-4922-917b-65fa13dfe38c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18820, 411, 312, 5, 101, "Section",ExpressionUUID->"b7f9abea-dd58-4b5a-9aca-1d3a997b4197"],
Cell[19135, 418, 2897, 61, 388, "Input",ExpressionUUID->"e7f15050-78af-4652-8d14-ded069b66ef2"],
Cell[22035, 481, 4435, 99, 636, "Input",ExpressionUUID->"3263382f-7d59-4672-91d5-01095e16560a"],
Cell[26473, 582, 462, 8, 46, "Input",ExpressionUUID->"ba87c365-2395-4812-8c68-612830bc5903"],
Cell[26938, 592, 12575, 242, 1628, "Input",ExpressionUUID->"a7a8cbab-c0c5-4b9a-a382-74b6e6e01ecb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39550, 839, 175, 3, 101, "Section",ExpressionUUID->"3fd0dad5-8c33-459c-99af-23be22ac74cc"],
Cell[39728, 844, 297, 6, 46, "Input",ExpressionUUID->"4242f150-a5b7-47aa-9bfa-7843ce82e606"],
Cell[40028, 852, 4170, 110, 605, "Input",ExpressionUUID->"539e0b04-bddf-4b3f-b649-48c0ad6cbdbd"],
Cell[44201, 964, 481, 10, 46, "Input",ExpressionUUID->"601fba62-0d9c-4b38-bd2c-6711e757318d"],
Cell[44685, 976, 3038, 78, 450, "Input",ExpressionUUID->"0625c506-e8b9-404b-8b18-3a5dd2741cf6"],
Cell[47726, 1056, 451, 8, 46, "Input",ExpressionUUID->"01762346-bb49-4779-8818-ea08463a58f5"],
Cell[48180, 1066, 2306, 60, 419, "Input",ExpressionUUID->"76d32a94-d964-48ac-8f68-34bbc02fcdfc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50523, 1131, 253, 4, 101, "Section",ExpressionUUID->"4d202cee-5d4d-4761-94cc-9a877b4cb9be"],
Cell[50779, 1137, 649, 11, 78, "Input",ExpressionUUID->"6674d767-7c3e-4406-999c-06c5bbb6b854"],
Cell[51431, 1150, 4383, 104, 636, "Input",ExpressionUUID->"089ff342-ab3d-4e92-84e8-18beb7616f6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55851, 1259, 154, 3, 101, "Section",ExpressionUUID->"04e4365a-4c74-4fec-9c08-24152d272ced"],
Cell[56008, 1264, 688, 11, 78, "Input",ExpressionUUID->"6b7b6844-3303-41ef-8dd5-9cab5d4d0deb"],
Cell[56699, 1277, 3556, 88, 512, "Input",ExpressionUUID->"f8d36ff1-ff5c-45c9-93a3-9328417e0894"],
Cell[60258, 1367, 600, 12, 78, "Input",ExpressionUUID->"0cbe1306-08c3-46af-bf91-e40e4ab669a7"],
Cell[60861, 1381, 11951, 267, 1783, "Input",ExpressionUUID->"b823e941-bb77-420a-b7dd-dabf1e44f1d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72849, 1653, 152, 3, 101, "Section",ExpressionUUID->"9742075c-8cfe-4c07-947d-e2c1a1b0df4b"],
Cell[73004, 1658, 594, 10, 46, "Input",ExpressionUUID->"a8648c76-10cd-4f0e-8d28-c308cf95f202"],
Cell[73601, 1670, 2500, 67, 419, "Input",ExpressionUUID->"1376b9a1-ea8e-4e7e-bd05-07385552aa9c"],
Cell[76104, 1739, 636, 10, 78, "Input",ExpressionUUID->"bc673727-56ba-4bbf-b2a7-fba7a2b37741"],
Cell[76743, 1751, 2419, 60, 481, "Input",ExpressionUUID->"4533220b-394f-4837-864e-176faa31a77f"],
Cell[79165, 1813, 598, 12, 78, "Input",ExpressionUUID->"18fcdb66-3c0b-4e93-8108-05189671f28c"],
Cell[79766, 1827, 7623, 195, 1318, "Input",ExpressionUUID->"616b8610-2ee5-4fc3-a42b-97d75be6b274"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87426, 2027, 160, 3, 101, "Section",ExpressionUUID->"90900b2e-3380-4ed8-8d4f-e2797d625409"],
Cell[87589, 2032, 419, 7, 46, "Input",ExpressionUUID->"baee523c-a8fb-4c09-9e7c-919256ce9bc8"],
Cell[88011, 2041, 9973, 259, 1752, "Input",ExpressionUUID->"015a9168-6c42-434b-baf1-88480d2f6000"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98021, 2305, 247, 4, 101, "Section",ExpressionUUID->"069b5f0e-d67f-4af5-af80-b85a5650059b"],
Cell[98271, 2311, 496, 11, 46, "Input",ExpressionUUID->"7d14ccf2-d17e-49be-9000-2823e17e12f4"],
Cell[98770, 2324, 2962, 81, 388, "Input",ExpressionUUID->"e82f3a0a-805b-4ba6-92f1-4ce563292a26"],
Cell[101735, 2407, 433, 10, 46, "Input",ExpressionUUID->"7a294361-3957-4d64-b0e7-bbe1180caf73"],
Cell[102171, 2419, 2425, 66, 326, "Input",ExpressionUUID->"186361dc-1941-4bd9-b529-2b45998d43f6"],
Cell[104599, 2487, 431, 10, 46, "Input",ExpressionUUID->"2728142b-deb6-4bf8-a7bc-45f89ac21bef"],
Cell[105033, 2499, 2351, 66, 295, "Input",ExpressionUUID->"67ec7703-e631-403f-9062-2521f4ea6619"],
Cell[107387, 2567, 565, 14, 46, "Input",ExpressionUUID->"00a70768-c7c8-4481-ab68-12ec13c2cd1e"],
Cell[107955, 2583, 1950, 55, 264, "Input",ExpressionUUID->"32b5689e-b8c0-4f8f-9c0a-0bddddba303a"],
Cell[109908, 2640, 373, 11, 46, "Input",ExpressionUUID->"043a11d2-c284-4bfe-a773-76587a67d2bc"],
Cell[110284, 2653, 3265, 82, 481, "Input",ExpressionUUID->"658bb0a0-1184-45db-9628-c8f5668e529e"],
Cell[113552, 2737, 439, 12, 46, "Input",ExpressionUUID->"8c5d753d-35fa-4156-bede-1671f85c8f0e"],
Cell[113994, 2751, 3070, 79, 481, "Input",ExpressionUUID->"c8e5c3d3-28d3-4a39-a295-b2cc5583112d"],
Cell[117067, 2832, 303, 6, 46, "Input",ExpressionUUID->"b46bbafb-5010-4341-89af-5aec9df58643"],
Cell[117373, 2840, 2030, 50, 357, "Input",ExpressionUUID->"fee92682-4d86-487f-8b04-f8bb8632ea0e"],
Cell[119406, 2892, 8297, 206, 1442, "Input",ExpressionUUID->"f3b9b959-78af-4855-89c6-d437182af864"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127740, 3103, 242, 4, 101, "Section",ExpressionUUID->"0adc6fe7-eeb3-4dc4-b6a0-000a78ed2888"],
Cell[127985, 3109, 450, 8, 46, "Input",ExpressionUUID->"b8b680fb-8486-4019-8a8a-24f37d69f1f7"],
Cell[128438, 3119, 8360, 190, 1380, "Input",ExpressionUUID->"c5b3b26b-ba71-4898-b21b-d51c8215da5e"],
Cell[136801, 3311, 503, 7, 46, "Input",ExpressionUUID->"1175b9b5-dd42-4f8d-b2b9-a4292c1d0b46"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137341, 3323, 159, 3, 101, "Section",ExpressionUUID->"711b8952-e457-4870-af14-cc87cf2f4025"],
Cell[137503, 3328, 2120, 55, 295, "Input",ExpressionUUID->"dd4f115e-8aa3-436b-a134-ee5647157597"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139660, 3388, 189, 3, 101, "Section",ExpressionUUID->"9fcafe7d-2039-4464-9b43-56606603aa3e"],
Cell[139852, 3393, 2824, 73, 512, "Input",ExpressionUUID->"363a263e-5b17-4a24-8ae9-32883dd7746e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142713, 3471, 240, 4, 101, "Section",ExpressionUUID->"4f8b2a0a-57eb-4911-bde6-32ad27d4974d"],
Cell[142956, 3477, 4103, 90, 585, "Input",ExpressionUUID->"baebf980-f365-4895-9812-82795b7dd488"],
Cell[147062, 3569, 4846, 106, 915, "Input",ExpressionUUID->"7f613095-eb7c-451e-97f4-673aab9f196e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151945, 3680, 178, 3, 101, "Section",ExpressionUUID->"a0eb1f69-e7ee-490f-be00-5ce61173ce38"],
Cell[152126, 3685, 1641, 40, 357, "Input",ExpressionUUID->"08851f03-4cdd-41b2-8230-f583d19dcc5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153804, 3730, 188, 3, 101, "Section",ExpressionUUID->"c3f3db05-349c-422f-80a1-e96221f87e80"],
Cell[153995, 3735, 31771, 694, 4666, "Input",ExpressionUUID->"0e1966a2-3dfa-4171-aae5-8928c420b765"]
}, Open  ]]
}
]
*)

